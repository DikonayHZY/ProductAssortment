<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Study1</title>
    <script type="text/javascript" src="template_2.js"></script>
    <script type="text/javascript" src="template_4.js"></script>
    <script type="text/javascript" src="template_5.js"></script>
    <script type="text/javascript" src="template_9.js"></script>
    <script type="text/javascript" src="template_10.js"></script>
    <script type="text/javascript">
        
        var username = "黄梓仪小猴子";

        var order_map = [
                            ["tea","brush","shampoo"],
                            ["tea","shampoo","brush"],
                            ["brush","tea","shampoo"],
                            ["brush","shampoo","tea"],
                            ["shampoo","tea","brush"],
                            ["shampoo","brush","tea"]
                        ]; 
        var order = order_map[0];
        var condition = "attr_" + order.join("_");     // "attr_tea_brush_shampoo"
        console.log("order:", order);
        console.log("condition:", condition);

        var title_color_map = {
            "绿茶1": "#90A71F",
            "红茶2": "#CA6931",
            "青茶3": "#B27511",
            "花茶4": "#CE6E60",
        }

	    var config_tea = {
            "name": "tea",
	        "product1":[
	            [0, "../resource/茶叶图鉴/绿茶-雪水云绿.JPG", "绿茶1", "美容颜料", "银剑出鞘，茸毫隐翠，林间香气","延缓衰老，防癌抗癌"],
	            [0, "../resource/茶叶图鉴/绿茶-休宁松萝.JPG", "绿茶1", "美容颜料", "紧卷匀壮，色泽绿润，橄榄风味","提神醒脑，清心明目"],
	            [0, "../resource/茶叶图鉴/绿茶-信阳毛尖.JPG", "绿茶1", "美容颜料", "匀整细直，白毫隐翠，有熟果香","消脂减脂，净化肠胃"],
	            [0, "../resource/茶叶图鉴/绿茶-西湖龙井.JPG", "绿茶1", "美容颜料", "扁而平直，绿中透黄，有炒豆香","降低血脂，防癌抗癌，抗菌消炎"],
	            [0, "../resource/茶叶图鉴/绿茶-太平猴魁.JPG", "绿茶1", "美容颜料", "两叶抱芽，绿中隐红，兰香高爽","促进血液循环，松弛平滑肌"],
	            [0, "../resource/茶叶图鉴/绿茶-千岛玉叶.JPG", "绿茶1", "美容颜料", "扁平挺直，翠绿嫩黄，兰蕙之清","抗老，防癌，养颜，抗菌"],
	            [0, "../resource/茶叶图鉴/绿茶-蒙顶甘露.JPG", "绿茶1", "美容颜料", "紧凑多毫，浅绿油润，香气馥郁","好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/绿茶-梅尖银毫.JPG", "绿茶1", "美容颜料", "紧细圆直，翠绿显毫，香气浓郁","抗氧化，养颜健身"],
	            [0, "../resource/茶叶图鉴/绿茶-庐山云雾茶.JPG", "绿茶1", "美容颜料", "条索紧结，青翠多毫，有板栗香","消脂减脂，减肥瘦身"],
	            [0, "../resource/茶叶图鉴/绿茶-六安瓜片.JPG", "绿茶1", "美容颜料", "瓜子形单叶，叶底嫩黄，熟栗香味","降低血脂，促进消化"],
	            [0, "../resource/茶叶图鉴/绿茶-莲心绿茶.JPG", "绿茶1", "美容颜料", "芽叶成朵，色泽黄绿，绿豆香气","抵御放射性元素，防治坏血病"],
	            [0, "../resource/茶叶图鉴/绿茶-开化龙顶.JPG", "绿茶1", "美容颜料","紧直挺秀，银绿翠隐，淡青草味","清热解毒，固齿防龋"],
	            [0, "../resource/茶叶图鉴/绿茶-径山茶.JPG", "绿茶1", "美容颜料","纤细微曲，色泽绿翠，板栗香味","排毒养颜，抗氧化"],
	            [0, "../resource/茶叶图鉴/绿茶-黄山毛峰.JPG", "绿茶1", "美容颜料","细扁微卷，银毫显露，香气如兰","利尿消肿，防癌抗癌，固齿防龋"],
	            [0, "../resource/茶叶图鉴/绿茶-狗牯脑茶.JPG", "绿茶1", "美容颜料","紧结微勾，黛绿莹润，清心雅郁","利尿解毒，防治心血管疾病"],
	            [0, "../resource/茶叶图鉴/绿茶-碧螺春.JPG", "绿茶1", "美容颜料","形状如螺，白毫隐翠，清香淡雅","提神解乏，抗菌消炎"],
	        ],
	        "product2":[
	            [0, "../resource/茶叶图鉴/红茶-政和工夫.JPG", "红茶2", "美容颜料", "条索重实，毫尖金黄，紫罗兰香", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/红茶-正山小种.JPG", "红茶2", "美容颜料", "条索肥壮，呈红褐色，有松烟香", "利尿排毒，强壮骨骼，护心养胃"],
	            [0, "../resource/茶叶图鉴/红茶-英红.JPG", "红茶2", "美容颜料", "外形重实，色泽乌润，香气浓郁", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/红茶-银骏眉.JPG", "红茶2", "美容颜料", "条索紧细，乌润带金，花果清香", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/红茶-宜红.JPG", "红茶2", "美容颜料", "条索紧细，略带金毫，花果清香", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/红茶-信阳红.JPG", "红茶2", "美容颜料", "条索匀整，乌黑披金，有花果香", "消炎杀菌，利尿解毒"],
	            [0, "../resource/茶叶图鉴/红茶-坦洋工夫.JPG", "红茶2", "美容颜料", "条索紧细，毫尖金黄，桂圆香气", "减肥瘦身，养胃护胃"],
	            [0, "../resource/茶叶图鉴/红茶-祁门红茶.JPG", "红茶2", "美容颜料", "条索紧细，色泽乌润，兰果香气", "防治心血管疾病，清凉消暑"],
	            [0, "../resource/茶叶图鉴/红茶-宁红.JPG", "红茶2", "美容颜料", "紧结圆直，略显红筋，鲜香持久", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/红茶-荔枝红.JPG", "红茶2", "美容颜料", "条索纤秀，乌黑油润，香气清幽", "风味独特，好喝"],
	            [0, "../resource/茶叶图鉴/红茶-九曲红梅.JPG", "红茶2", "美容颜料", "细若发丝，金色绒毛，似蜜糖香", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/红茶-金骏眉.JPG", "红茶2", "美容颜料", "细瘦卷曲，乌中透金，烤红薯香", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/红茶-滇红.JPG", "红茶2", "美容颜料", "紧结肥壮，色泽乌润，香气鲜锐", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/红茶-川红.JPG", "红茶2", "美容颜料", "紧细圆直，色泽乌润，带枯糖香", "好喝，身心愉悦"],
	        ],
	        "product3":[
	            [0, "../resource/茶叶图鉴/青茶-永春佛手.JPG", "青茶3", "美容颜料","紧结肥壮，砂率乌润，香气悠长", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/青茶-武夷水仙.JPG", "青茶3", "美容颜料","叶端扭曲，油润暗绿，兰花香郁", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/青茶-武夷肉桂.JPG", "青茶3", "美容颜料","匀整卷曲，褐绿油润，桂皮香味", "改善皮肤敏感溃烂，延缓衰老"],
	            [0, "../resource/茶叶图鉴/青茶-武夷大红袍.JPG", "青茶3", "美容颜料","条索紧结，绿褐鲜润，有兰花香", "美白抗氧化，醒酒敌烟"],
	            [0, "../resource/茶叶图鉴/青茶-铁罗汉.JPG", "青茶3", "美容颜料","条索匀整，褐绿鲜润， 兰香馥郁", "耐泡，好喝"],
	            [0, "../resource/茶叶图鉴/青茶-水金龟.JPG", "青茶3", "美容颜料","条索紧结，色泽青褐，清雅高长", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/青茶-高山乌龙.JPG", "青茶3", "美容颜料","半球形状，色泽深绿，花香突出", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/青茶-凤凰水仙.JPG", "青茶3", "美容颜料","挺直肥大，鳝鱼皮色，天然花香", "清热解暑，生津止渴"],
	            [0, "../resource/茶叶图鉴/青茶-凤凰单枞.JPG", "青茶3", "美容颜料","条索匀直，黄褐油润，独特花香", "改善皮肤过敏，养颜促代谢"],
	            [0, "../resource/茶叶图鉴/青茶-冻顶乌龙.JPG", "青茶3", "美容颜料","呈半球形，色泽墨绿，有桂花香", "消脂减肥，抗氧化"],
	            [0, "../resource/茶叶图鉴/青茶-东方美人.JPG", "青茶3", "美容颜料","茶心肥厚，满披茸毛，有熟果香", "消脂减肥，降低血脂"],
	            [0, "../resource/茶叶图鉴/青茶-白芽奇兰.JPG", "青茶3", "美容颜料","紧结匀整，翠绿油润，兰花香味", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/青茶-白鸡冠.JPG", "青茶3", "美容颜料","条索紧结，色泽灰暗，香气悠长", "清心明目，提神解乏"],
	            [0, "../resource/茶叶图鉴/青茶-安溪铁观音.JPG", "青茶3", "美容颜料","卷曲圆结，色泽砂绿，有兰花香", "抗氧化，防治龋齿"],
	            [0, "../resource/茶叶图鉴/青茶-阿里山乌龙.JPG", "青茶3", "美容颜料","呈半球形，色泽砂绿，清新典雅", "好喝，身心愉悦"],
	        ],
	        "product4":[
	            [0, "../resource/茶叶图鉴/花茶-茉莉花茶.JPG", "花茶4", "美容颜料","紧细圆整，黄中带褐，灵香持久", "好喝，身心愉悦"],
	            [0, "../resource/茶叶图鉴/花茶-玫瑰花茶.JPG", "花茶4", "美容颜料","朵大饱满，色泽均匀，香味清淡", "消脂减肥，促进消化"],
	            [0, "../resource/茶叶图鉴/花茶-苦丁茶.JPG", "花茶4", "美容颜料","条索紧结，灰绿相间，清香带苦", "降压降脂，清热消暑"],
	            [0, "../resource/茶叶图鉴/花茶-黄山贡菊.JPG", "花茶4", "美容颜料","朵大均匀，色白蒂绿，菊花香味", "护肤美容，排毒护肝"],
	            [0, "../resource/茶叶图鉴/花茶-杭白菊.JPG", "花茶4", "美容颜料","花形完整，嫩黄鲜亮，香气清冽", "清热解毒，消食醒酒"],
	        ],
	    };

	    var question_tea = {
            "questions":[
                {"id":"tea1", "template": template_2, "content":"绿茶绿茶？", "left": "是", "right": "不是"},
                {"id":"tea2", "template": template_4, "content":"我感觉完成产品选择的任务需要进行较多的思考？？？", "left": "非常不不符合", "right": "非常符合？"},
            ]
        };

        var config_shampoo = {
            "name": "shampoo",
            "product1":[
                [0, "../resource/茶叶图鉴/绿茶-雪水云绿.JPG", "绿茶1", "美容颜料", "银剑出鞘，茸毫隐翠，林间香气","延缓衰老，防癌抗癌"],
                [0, "../resource/茶叶图鉴/绿茶-休宁松萝.JPG", "绿茶1", "美容颜料", "紧卷匀壮，色泽绿润，橄榄风味","提神醒脑，清心明目"],
                [0, "../resource/茶叶图鉴/绿茶-信阳毛尖.JPG", "绿茶1", "美容颜料", "匀整细直，白毫隐翠，有熟果香","消脂减脂，净化肠胃"],
                [0, "../resource/茶叶图鉴/绿茶-西湖龙井.JPG", "绿茶1", "美容颜料", "扁而平直，绿中透黄，有炒豆香","降低血脂，防癌抗癌，抗菌消炎"],
                [0, "../resource/茶叶图鉴/绿茶-太平猴魁.JPG", "绿茶1", "美容颜料", "两叶抱芽，绿中隐红，兰香高爽","促进血液循环，松弛平滑肌"],
                [0, "../resource/茶叶图鉴/绿茶-千岛玉叶.JPG", "绿茶1", "美容颜料", "扁平挺直，翠绿嫩黄，兰蕙之清","抗老，防癌，养颜，抗菌"],
                [0, "../resource/茶叶图鉴/绿茶-蒙顶甘露.JPG", "绿茶1", "美容颜料", "紧凑多毫，浅绿油润，香气馥郁","好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/绿茶-梅尖银毫.JPG", "绿茶1", "美容颜料", "紧细圆直，翠绿显毫，香气浓郁","抗氧化，养颜健身"],
                [0, "../resource/茶叶图鉴/绿茶-庐山云雾茶.JPG", "绿茶1", "美容颜料", "条索紧结，青翠多毫，有板栗香","消脂减脂，减肥瘦身"],
                [0, "../resource/茶叶图鉴/绿茶-六安瓜片.JPG", "绿茶1", "美容颜料", "瓜子形单叶，叶底嫩黄，熟栗香味","降低血脂，促进消化"],
                [0, "../resource/茶叶图鉴/绿茶-莲心绿茶.JPG", "绿茶1", "美容颜料", "芽叶成朵，色泽黄绿，绿豆香气","抵御放射性元素，防治坏血病"],
                [0, "../resource/茶叶图鉴/绿茶-开化龙顶.JPG", "绿茶1", "美容颜料","紧直挺秀，银绿翠隐，淡青草味","清热解毒，固齿防龋"],
                [0, "../resource/茶叶图鉴/绿茶-径山茶.JPG", "绿茶1", "美容颜料","纤细微曲，色泽绿翠，板栗香味","排毒养颜，抗氧化"],
                [0, "../resource/茶叶图鉴/绿茶-黄山毛峰.JPG", "绿茶1", "美容颜料","细扁微卷，银毫显露，香气如兰","利尿消肿，防癌抗癌，固齿防龋"],
                [0, "../resource/茶叶图鉴/绿茶-狗牯脑茶.JPG", "绿茶1", "美容颜料","紧结微勾，黛绿莹润，清心雅郁","利尿解毒，防治心血管疾病"],
                [0, "../resource/茶叶图鉴/绿茶-碧螺春.JPG", "绿茶1", "美容颜料","形状如螺，白毫隐翠，清香淡雅","提神解乏，抗菌消炎"],
            ],
            "product2":[
                [0, "../resource/茶叶图鉴/红茶-政和工夫.JPG", "红茶2", "美容颜料", "条索重实，毫尖金黄，紫罗兰香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-正山小种.JPG", "红茶2", "美容颜料", "条索肥壮，呈红褐色，有松烟香", "利尿排毒，强壮骨骼，护心养胃"],
                [0, "../resource/茶叶图鉴/红茶-英红.JPG", "红茶2", "美容颜料", "外形重实，色泽乌润，香气浓郁", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-银骏眉.JPG", "红茶2", "美容颜料", "条索紧细，乌润带金，花果清香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-宜红.JPG", "红茶2", "美容颜料", "条索紧细，略带金毫，花果清香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-信阳红.JPG", "红茶2", "美容颜料", "条索匀整，乌黑披金，有花果香", "消炎杀菌，利尿解毒"],
                [0, "../resource/茶叶图鉴/红茶-坦洋工夫.JPG", "红茶2", "美容颜料", "条索紧细，毫尖金黄，桂圆香气", "减肥瘦身，养胃护胃"],
                [0, "../resource/茶叶图鉴/红茶-祁门红茶.JPG", "红茶2", "美容颜料", "条索紧细，色泽乌润，兰果香气", "防治心血管疾病，清凉消暑"],
                [0, "../resource/茶叶图鉴/红茶-宁红.JPG", "红茶2", "美容颜料", "紧结圆直，略显红筋，鲜香持久", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-荔枝红.JPG", "红茶2", "美容颜料", "条索纤秀，乌黑油润，香气清幽", "风味独特，好喝"],
                [0, "../resource/茶叶图鉴/红茶-九曲红梅.JPG", "红茶2", "美容颜料", "细若发丝，金色绒毛，似蜜糖香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-金骏眉.JPG", "红茶2", "美容颜料", "细瘦卷曲，乌中透金，烤红薯香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-滇红.JPG", "红茶2", "美容颜料", "紧结肥壮，色泽乌润，香气鲜锐", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-川红.JPG", "红茶2", "美容颜料", "紧细圆直，色泽乌润，带枯糖香", "好喝，身心愉悦"],
            ],
            "product3":[
                [0, "../resource/茶叶图鉴/青茶-永春佛手.JPG", "青茶3", "美容颜料","紧结肥壮，砂率乌润，香气悠长", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-武夷水仙.JPG", "青茶3", "美容颜料","叶端扭曲，油润暗绿，兰花香郁", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-武夷肉桂.JPG", "青茶3", "美容颜料","匀整卷曲，褐绿油润，桂皮香味", "改善皮肤敏感溃烂，延缓衰老"],
                [0, "../resource/茶叶图鉴/青茶-武夷大红袍.JPG", "青茶3", "美容颜料","条索紧结，绿褐鲜润，有兰花香", "美白抗氧化，醒酒敌烟"],
                [0, "../resource/茶叶图鉴/青茶-铁罗汉.JPG", "青茶3", "美容颜料","条索匀整，褐绿鲜润， 兰香馥郁", "耐泡，好喝"],
                [0, "../resource/茶叶图鉴/青茶-水金龟.JPG", "青茶3", "美容颜料","条索紧结，色泽青褐，清雅高长", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-高山乌龙.JPG", "青茶3", "美容颜料","半球形状，色泽深绿，花香突出", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-凤凰水仙.JPG", "青茶3", "美容颜料","挺直肥大，鳝鱼皮色，天然花香", "清热解暑，生津止渴"],
                [0, "../resource/茶叶图鉴/青茶-凤凰单枞.JPG", "青茶3", "美容颜料","条索匀直，黄褐油润，独特花香", "改善皮肤过敏，养颜促代谢"],
                [0, "../resource/茶叶图鉴/青茶-冻顶乌龙.JPG", "青茶3", "美容颜料","呈半球形，色泽墨绿，有桂花香", "消脂减肥，抗氧化"],
                [0, "../resource/茶叶图鉴/青茶-东方美人.JPG", "青茶3", "美容颜料","茶心肥厚，满披茸毛，有熟果香", "消脂减肥，降低血脂"],
                [0, "../resource/茶叶图鉴/青茶-白芽奇兰.JPG", "青茶3", "美容颜料","紧结匀整，翠绿油润，兰花香味", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-白鸡冠.JPG", "青茶3", "美容颜料","条索紧结，色泽灰暗，香气悠长", "清心明目，提神解乏"],
                [0, "../resource/茶叶图鉴/青茶-安溪铁观音.JPG", "青茶3", "美容颜料","卷曲圆结，色泽砂绿，有兰花香", "抗氧化，防治龋齿"],
                [0, "../resource/茶叶图鉴/青茶-阿里山乌龙.JPG", "青茶3", "美容颜料","呈半球形，色泽砂绿，清新典雅", "好喝，身心愉悦"],
            ],
            "product4":[
                [0, "../resource/茶叶图鉴/花茶-茉莉花茶.JPG", "花茶4", "美容颜料","紧细圆整，黄中带褐，灵香持久", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/花茶-玫瑰花茶.JPG", "花茶4", "美容颜料","朵大饱满，色泽均匀，香味清淡", "消脂减肥，促进消化"],
                [0, "../resource/茶叶图鉴/花茶-苦丁茶.JPG", "花茶4", "美容颜料","条索紧结，灰绿相间，清香带苦", "降压降脂，清热消暑"],
                [0, "../resource/茶叶图鉴/花茶-黄山贡菊.JPG", "花茶4", "美容颜料","朵大均匀，色白蒂绿，菊花香味", "护肤美容，排毒护肝"],
                [0, "../resource/茶叶图鉴/花茶-杭白菊.JPG", "花茶4", "美容颜料","花形完整，嫩黄鲜亮，香气清冽", "清热解毒，消食醒酒"],
            ],
        };


        var question_shampoo = {
            "questions":[
                {"id":"shampoo1", "template": template_2, "content":"1绿茶绿茶？", "left": "是111", "right": "不是111"},
                {"id":"shampoo2", "template": template_4, "content":"2我感觉完成产品选择的任务需要进行较多的思考？？？", "left": "111非常不不符合？？", "right": "2非常符合？"},
                {"id":"shampoo3", "template": template_5, "content":"3在完成选择任务之时, 我感觉有较多的可选产品？？？", "left": "111非常不赞同？？", "right": "2非常赞同？"},
            ]
        };

        var config_brush = {
            "name": "bursh",
            "product1":[
                [0, "../resource/茶叶图鉴/绿茶-雪水云绿.JPG", "绿茶1", "美容颜料", "银剑出鞘，茸毫隐翠，林间香气","延缓衰老，防癌抗癌"],
                [0, "../resource/茶叶图鉴/绿茶-休宁松萝.JPG", "绿茶1", "美容颜料", "紧卷匀壮，色泽绿润，橄榄风味","提神醒脑，清心明目"],
                [0, "../resource/茶叶图鉴/绿茶-信阳毛尖.JPG", "绿茶1", "美容颜料", "匀整细直，白毫隐翠，有熟果香","消脂减脂，净化肠胃"],
                [0, "../resource/茶叶图鉴/绿茶-西湖龙井.JPG", "绿茶1", "美容颜料", "扁而平直，绿中透黄，有炒豆香","降低血脂，防癌抗癌，抗菌消炎"],
                [0, "../resource/茶叶图鉴/绿茶-太平猴魁.JPG", "绿茶1", "美容颜料", "两叶抱芽，绿中隐红，兰香高爽","促进血液循环，松弛平滑肌"],
                [0, "../resource/茶叶图鉴/绿茶-千岛玉叶.JPG", "绿茶1", "美容颜料", "扁平挺直，翠绿嫩黄，兰蕙之清","抗老，防癌，养颜，抗菌"],
                [0, "../resource/茶叶图鉴/绿茶-蒙顶甘露.JPG", "绿茶1", "美容颜料", "紧凑多毫，浅绿油润，香气馥郁","好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/绿茶-梅尖银毫.JPG", "绿茶1", "美容颜料", "紧细圆直，翠绿显毫，香气浓郁","抗氧化，养颜健身"],
                [0, "../resource/茶叶图鉴/绿茶-庐山云雾茶.JPG", "绿茶1", "美容颜料", "条索紧结，青翠多毫，有板栗香","消脂减脂，减肥瘦身"],
                [0, "../resource/茶叶图鉴/绿茶-六安瓜片.JPG", "绿茶1", "美容颜料", "瓜子形单叶，叶底嫩黄，熟栗香味","降低血脂，促进消化"],
                [0, "../resource/茶叶图鉴/绿茶-莲心绿茶.JPG", "绿茶1", "美容颜料", "芽叶成朵，色泽黄绿，绿豆香气","抵御放射性元素，防治坏血病"],
                [0, "../resource/茶叶图鉴/绿茶-开化龙顶.JPG", "绿茶1", "美容颜料","紧直挺秀，银绿翠隐，淡青草味","清热解毒，固齿防龋"],
                [0, "../resource/茶叶图鉴/绿茶-径山茶.JPG", "绿茶1", "美容颜料","纤细微曲，色泽绿翠，板栗香味","排毒养颜，抗氧化"],
                [0, "../resource/茶叶图鉴/绿茶-黄山毛峰.JPG", "绿茶1", "美容颜料","细扁微卷，银毫显露，香气如兰","利尿消肿，防癌抗癌，固齿防龋"],
                [0, "../resource/茶叶图鉴/绿茶-狗牯脑茶.JPG", "绿茶1", "美容颜料","紧结微勾，黛绿莹润，清心雅郁","利尿解毒，防治心血管疾病"],
                [0, "../resource/茶叶图鉴/绿茶-碧螺春.JPG", "绿茶1", "美容颜料","形状如螺，白毫隐翠，清香淡雅","提神解乏，抗菌消炎"],
            ],
            "product2":[
                [0, "../resource/茶叶图鉴/红茶-政和工夫.JPG", "红茶2", "美容颜料", "条索重实，毫尖金黄，紫罗兰香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-正山小种.JPG", "红茶2", "美容颜料", "条索肥壮，呈红褐色，有松烟香", "利尿排毒，强壮骨骼，护心养胃"],
                [0, "../resource/茶叶图鉴/红茶-英红.JPG", "红茶2", "美容颜料", "外形重实，色泽乌润，香气浓郁", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-银骏眉.JPG", "红茶2", "美容颜料", "条索紧细，乌润带金，花果清香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-宜红.JPG", "红茶2", "美容颜料", "条索紧细，略带金毫，花果清香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-信阳红.JPG", "红茶2", "美容颜料", "条索匀整，乌黑披金，有花果香", "消炎杀菌，利尿解毒"],
                [0, "../resource/茶叶图鉴/红茶-坦洋工夫.JPG", "红茶2", "美容颜料", "条索紧细，毫尖金黄，桂圆香气", "减肥瘦身，养胃护胃"],
                [0, "../resource/茶叶图鉴/红茶-祁门红茶.JPG", "红茶2", "美容颜料", "条索紧细，色泽乌润，兰果香气", "防治心血管疾病，清凉消暑"],
                [0, "../resource/茶叶图鉴/红茶-宁红.JPG", "红茶2", "美容颜料", "紧结圆直，略显红筋，鲜香持久", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-荔枝红.JPG", "红茶2", "美容颜料", "条索纤秀，乌黑油润，香气清幽", "风味独特，好喝"],
                [0, "../resource/茶叶图鉴/红茶-九曲红梅.JPG", "红茶2", "美容颜料", "细若发丝，金色绒毛，似蜜糖香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-金骏眉.JPG", "红茶2", "美容颜料", "细瘦卷曲，乌中透金，烤红薯香", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-滇红.JPG", "红茶2", "美容颜料", "紧结肥壮，色泽乌润，香气鲜锐", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/红茶-川红.JPG", "红茶2", "美容颜料", "紧细圆直，色泽乌润，带枯糖香", "好喝，身心愉悦"],
            ],
            "product3":[
                [0, "../resource/茶叶图鉴/青茶-永春佛手.JPG", "青茶3", "美容颜料","紧结肥壮，砂率乌润，香气悠长", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-武夷水仙.JPG", "青茶3", "美容颜料","叶端扭曲，油润暗绿，兰花香郁", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-武夷肉桂.JPG", "青茶3", "美容颜料","匀整卷曲，褐绿油润，桂皮香味", "改善皮肤敏感溃烂，延缓衰老"],
                [0, "../resource/茶叶图鉴/青茶-武夷大红袍.JPG", "青茶3", "美容颜料","条索紧结，绿褐鲜润，有兰花香", "美白抗氧化，醒酒敌烟"],
                [0, "../resource/茶叶图鉴/青茶-铁罗汉.JPG", "青茶3", "美容颜料","条索匀整，褐绿鲜润， 兰香馥郁", "耐泡，好喝"],
                [0, "../resource/茶叶图鉴/青茶-水金龟.JPG", "青茶3", "美容颜料","条索紧结，色泽青褐，清雅高长", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-高山乌龙.JPG", "青茶3", "美容颜料","半球形状，色泽深绿，花香突出", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-凤凰水仙.JPG", "青茶3", "美容颜料","挺直肥大，鳝鱼皮色，天然花香", "清热解暑，生津止渴"],
                [0, "../resource/茶叶图鉴/青茶-凤凰单枞.JPG", "青茶3", "美容颜料","条索匀直，黄褐油润，独特花香", "改善皮肤过敏，养颜促代谢"],
                [0, "../resource/茶叶图鉴/青茶-冻顶乌龙.JPG", "青茶3", "美容颜料","呈半球形，色泽墨绿，有桂花香", "消脂减肥，抗氧化"],
                [0, "../resource/茶叶图鉴/青茶-东方美人.JPG", "青茶3", "美容颜料","茶心肥厚，满披茸毛，有熟果香", "消脂减肥，降低血脂"],
                [0, "../resource/茶叶图鉴/青茶-白芽奇兰.JPG", "青茶3", "美容颜料","紧结匀整，翠绿油润，兰花香味", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/青茶-白鸡冠.JPG", "青茶3", "美容颜料","条索紧结，色泽灰暗，香气悠长", "清心明目，提神解乏"],
                [0, "../resource/茶叶图鉴/青茶-安溪铁观音.JPG", "青茶3", "美容颜料","卷曲圆结，色泽砂绿，有兰花香", "抗氧化，防治龋齿"],
                [0, "../resource/茶叶图鉴/青茶-阿里山乌龙.JPG", "青茶3", "美容颜料","呈半球形，色泽砂绿，清新典雅", "好喝，身心愉悦"],
            ],
            "product4":[
                [0, "../resource/茶叶图鉴/花茶-茉莉花茶.JPG", "花茶4", "美容颜料","紧细圆整，黄中带褐，灵香持久", "好喝，身心愉悦"],
                [0, "../resource/茶叶图鉴/花茶-玫瑰花茶.JPG", "花茶4", "美容颜料","朵大饱满，色泽均匀，香味清淡", "消脂减肥，促进消化"],
                [0, "../resource/茶叶图鉴/花茶-苦丁茶.JPG", "花茶4", "美容颜料","条索紧结，灰绿相间，清香带苦", "降压降脂，清热消暑"],
                [0, "../resource/茶叶图鉴/花茶-黄山贡菊.JPG", "花茶4", "美容颜料","朵大均匀，色白蒂绿，菊花香味", "护肤美容，排毒护肝"],
                [0, "../resource/茶叶图鉴/花茶-杭白菊.JPG", "花茶4", "美容颜料","花形完整，嫩黄鲜亮，香气清冽", "清热解毒，消食醒酒"],
            ],
        };


        var question_brush = {
            "questions":[
                {"id":"brush1", "template": template_2, "content":"2绿茶绿茶？", "left": "是", "right": "不是"},
                {"id":"brush2", "template": template_4, "content":"4我感觉完成产品选择的任务需要进行较多的思考？？？", "left": "非常不不符合？？", "right": "非常符合？"},
            ]
        };
        

        var product_config = config_tea;
        var product_question = question_tea;


    </script>
    <script type="text/javascript" src="../common/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="../common/FileSaver.js"></script>
    <script type="text/javascript" src="page_introduction.js"></script>
    <script type="text/javascript" src="page_tea_introduction.js"></script>
    <script type="text/javascript" src="page_tea_task.js"></script>
    <script type="text/javascript" src="page_tea_menu.js"></script>
    <script type="text/javascript" src="page_tea_product.js"></script>

    <script type="text/javascript" src="page_shampoo_introduction.js"></script>
    <script type="text/javascript" src="page_shampoo_task.js"></script>
    <script type="text/javascript" src="page_shampoo_menu.js"></script>
    <script type="text/javascript" src="page_shampoo_product.js"></script>

    <script type="text/javascript" src="page_brush_introduction.js"></script>
    <script type="text/javascript" src="page_brush_task.js"></script>
    <script type="text/javascript" src="page_brush_menu.js"></script>
    <script type="text/javascript" src="page_brush_product.js"></script>

    <script type="text/javascript" src="page_question.js"></script>
    <script type="text/javascript" src="page_phrase_transition.js"></script>
    <script type="text/javascript" src="page_final_submit.js"></script>


    <style>
        body, div, ul, li, a, p, span{
            margin: 0;
            padding: 0;
            border: 0;
            font-family: "Microsoft JhengHei";
            text-align: center;
        }

        a {
            text-decoration: none;
        }

        .shampoo_main_menu a:link, .shampoo_main_menu a:visited {
            color:#FFFFFF; 
        }
        .shampoo_main_menu a:hover, .shampoo_main_menu a:active {
            color:#999999; 
        }

        .shampoo_main_menu .line {
            font-size: 50px; 
            font-weight: 100; 
            font-family: "NSimSun";
        }

        .shampoo_left_menu a{
            font-size: 30px;
        }

        .shampoo_left_menu a:link, .shampoo_left_menu a:visited {
            color: #262626; 
        }
        .shampoo_left_menu a:hover, .shampoo_left_menu a:active {
            color: #999999; 
        }

        a:link, a:visited {
            color: black; 
        }
        a:hover, a:active {
            color: #999999; 
        }





        #main_menu li {
        	float: left;
        }

        #main_menu li a {
        	display:block; 
        	background: url(../resource/menu2.png);
        	overflow: hidden;
        	transition: all 0.2s ease;
        }

        #main_menu li.i1, li.i1 a {
			width: 150px; 
			height: 133px;
        }

        #main_menu li.i2, li.i2 a  {
			width: 167px; 
			height: 133px;
        }

        #main_menu li a.a1 {background-position: 0 0;}
        
        #main_menu li a.a1:hover {background-position: 0 -133px;}

        #main_menu li a.a2 {background-position: -150px 0;}

        #main_menu li a.a2:hover {background-position: -150px -133px;}

        #main_menu li a.a3 {background-position: -317px 0;}

        #main_menu li a.a3:hover {background-position: -317px -133px;}

        #main_menu li a.a4 {background-position: -484px 0;}

        #main_menu li a.a4:hover {background-position: -484px -133px;}

        #left_menu li a {
            display:block;
            background: url(../resource/menu3.png);
            overflow: hidden;
            transition: all 0.2s ease;
        }

        #left_menu li.i1, #left_menu li.i1 a {
            width: 133px;
            height: 150px;
        }

        #left_menu li.i2, #left_menu li.i2 a  {
            width: 133px;
            height: 167px;
        }

        #left_menu li a.a1 {background-position: 0 0;}

        #left_menu li a.a1:hover {background-position: -167px 0;}

        #left_menu li a.a2 {background-position: 0 -150px;}

        #left_menu li a.a2:hover {background-position: -167px -150px;}

        #left_menu li a.a3 {background-position: 0 -317px;}

        #left_menu li a.a3:hover {background-position: -167px -317px;}

        #left_menu li a.a4 {background-position: 0 -484px;}

        #left_menu li a.a4:hover {background-position: -167px -484px;}

        .each_product a:link, .each_product a:visited {
        	color: #000000; 
			text-decoration: none; 
        }
    </style>

</head>
<body>
</body>

<script type="text/javascript">

    var tea_task_after_init = function(){
        product_config = config_tea;
        product_question = question_tea;
        config["base"] = 0;
        clear_choice();
    }

    var shampoo_task_after_init = function(){
        product_config = config_shampoo;
        product_question = question_shampoo;
        config["base"] = 1000;
        clear_choice();
    }

    var brush_task_after_init = function(){
        product_config = config_brush;
        product_question = question_brush;
        config["base"] = 2000;
        clear_choice();
    }

    var config = {
        "base": 0,
        "current":1001,
        "pages": {
            1001: {"next":1002, "html":page_introduction, "wait":0, "auto":0, "before_init":null, "after_init":null},
            
            1002: {"next":1003, "html":page_tea_introduction, "wait":2, "auto":0, "before_init":null, "after_init":null},
            1003: {"next":1004, "html":page_tea_task, "wait":2, "auto":0, "before_init":null, "after_init":tea_task_after_init},
            1004: {"next":1004, "html":page_tea_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_product_menu_after_init},
            1005: {"next":1005, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product1_after_init},
            1006: {"next":1006, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product2_after_init},
            1007: {"next":1007, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product3_after_init},
            1008: {"next":1008, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product4_after_init},
            1009: {"next":1009, "html":page_question, "wait":0, "auto":0, "before_init":null, "after_init":page_question_after_init},
            1010: {"next":1010, "html":page_phrase_transition, "wait":0, "auto":0, "before_init":null, "after_init":page_phrase_transition_after_init},

            2002: {"next":2003, "html":page_shampoo_introduction, "wait":0, "auto":0, "before_init":null, "after_init":null},
            2003: {"next":2004, "html":page_shampoo_task, "wait":0, "auto":0, "before_init":null, "after_init":shampoo_task_after_init},
            2004: {"next":2005, "html":page_shampoo_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_product_menu_after_init},
            2005: {"next":2005, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product1_after_init},
            2006: {"next":2006, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product2_after_init},
            2007: {"next":2007, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product3_after_init},
            2008: {"next":2008, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product4_after_init},
            2009: {"next":2009, "html":page_question, "wait":0, "auto":0, "before_init":null, "after_init":page_question_after_init},
            2010: {"next":2010, "html":page_phrase_transition, "wait":0, "auto":0, "before_init":null, "after_init":page_phrase_transition_after_init},

            3002: {"next":3003, "html":page_brush_introduction, "wait":0, "auto":0, "before_init":null, "after_init":null},
            3003: {"next":3004, "html":page_brush_task, "wait":0, "auto":0, "before_init":null, "after_init":brush_task_after_init},
            3004: {"next":3005, "html":page_brush_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_product_menu_after_init},
            3005: {"next":3005, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product1_after_init},
            3006: {"next":3006, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product2_after_init},
            3007: {"next":3007, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product3_after_init},
            3008: {"next":3008, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product4_after_init},
            3009: {"next":3009, "html":page_question, "wait":0, "auto":0, "before_init":null, "after_init":page_question_after_init},
            3010: {"next":3010, "html":page_final_submit, "wait":0, "auto":0, "before_init":null, "after_init":page_final_submit_after_init},

        }
    };




    // 对Date的扩展，将 Date 转化为指定格式的String
    // 月(M)、日(d)、小时(h)、分(m)、秒(s)、季度(q) 可以用 1-2 个占位符，
    // 年(y)可以用 1-4 个占位符，毫秒(S)只能用 1 个占位符(是 1-3 位的数字)
    // 例子：
    // (new Date()).Format("yyyy-MM-dd hh:mm:ss.S") ==> 2006-07-02 08:09:04.423
    // (new Date()).Format("yyyy-M-d h:m:s.S")      ==> 2006-7-2 8:9:4.18
    Date.prototype.format = function(fmt)
    { //author: meizz
        var o = {
            "M+" : this.getMonth()+1,                 //月份
            "d+" : this.getDate(),                    //日
            "h+" : this.getHours(),                   //小时
            "m+" : this.getMinutes(),                 //分
            "s+" : this.getSeconds(),                 //秒
            "q+" : Math.floor((this.getMonth()+3)/3), //季度
            "S"  : this.getMilliseconds()             //毫秒
        };
        if(/(y+)/.test(fmt))
            fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));
        for(var k in o)
            if(new RegExp("("+ k +")").test(fmt))
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
        return fmt;
    }

    function set_body(html){
        $("body").html(html)
    }

    function saveFile(filename, file_content) {
        var file = new File([file_content], filename, { type:"text/plain;charset=utf-8" });
        saveAs(file);
    }

    function print_config(states) {
        console.log("current: ", states["current"]);
        for(var item in states["pages"]){
            var value = states["pages"][item]
            console.log("page:", item, "next", value["next"], "wait:", value["wait"], "auto:", value["auto"]);
            console.log(value["html"]);
            console.log("");
            console.log("");
        }
    }

    function change_state(states){
        var current = states["current"];
        var current_page = states["pages"][current];
        states["next"] = current_page["next"];
        states["html"] = current_page["html"];
        states["wait"] = current_page["wait"];
        states["auto"] = current_page["auto"];
        states["before_init"] = current_page["before_init"];
        states["after_init"] = current_page["after_init"];
        states["start"] = Date.parse(new Date());
        states["change"] = 0;
        if(states["before_init"]){
            states["before_init"]();
        }
        set_body(states["html"]);
        if(states["after_init"]){
            states["after_init"]();
        }
    };

    function working_machine(states) {
        if(states["change"] && (states["current"] != states["next"])){
            states["current"] = states["next"];
            change_state(states);
        }
    };

    function check_and_show_next(states){
        var time_spend = (Date.parse(new Date()) - states["start"]) / 1000;
        if(time_spend >= states["wait"]){
            if(states["auto"]){
                states["change"] = 1;
            }else{
                $("#next_tips").css("display","block")
            }
        }
    };

    function register_key_event(status) {
        // 设置父窗口事件
        document.onkeydown = function (event) {
            var e = event || window.event || arguments.callee.caller.arguments[0];
            console.log("press key code: ", e.keyCode);
            if(e && (e.keyCode == 13 || e.keyCode == 32 ||  e.keyCode == 78)){
                // keyCode: 13 Enter, keyCode: 32 Space, keyCode: 78 n N
                if(status["auto"] == 0){
                    var time_spend = (Date.parse(new Date()) - status["start"]) / 1000;   // 时间s
                    if(time_spend >= status["wait"]){
                        status["change"] = 1;
                    }else{
                        console.log("current:", status["current"], "spend:", time_spend, "wait:", status["wait"]);
                    }
                }else{
                    console.log("current page auto:", status["current"]);
                }
            }
        };
    };

    // page_product_menu 初始化绑定事件
    function page_product_menu_after_init(){
        $("#green_tea_main").unbind();
        $("#red_tea_main").unbind();
        $("#qing_tea_main").unbind();
        $("#hua_tea_main").unbind();

        $("#green_tea_main").on("click",product1_onclick);
        $("#red_tea_main").on("click",product2_onclick);
        $("#qing_tea_main").on("click",product3_onclick);
        $("#hua_tea_main").on("click",product4_onclick);

        choise["product1"] = random_choise_product(product_config["product1"], 5);
        choise["product2"] = random_choise_product(product_config["product2"], 5);
        choise["product3"] = random_choise_product(product_config["product3"], 5);
        choise["product4"] = random_choise_product(product_config["product4"], 5);

        console.log("product1:");
        for (var i = 0; i <choise["product1"].length; i++){
            console.log(choise["product1"][i]);
        }
        console.log("product2:");
        for (var i = 0; i <choise["product2"].length; i++){
            console.log(choise["product2"][i]);
        }
        console.log("product3:");
        for (var i = 0; i <choise["product3"].length; i++){
            console.log(choise["product3"][i]);
        }
        console.log("product4:");
        for (var i = 0; i <choise["product4"].length; i++){
            console.log(choise["product4"][i]);
        }
    }

    function product1_onclick(){
        config["current"] = 1005 + config["base"];
        change_state(config);
        choise["product1_click"] = 1;
        choise["start_time"] = new Date();
        console.log("product1_onclick:", choise["start_time"])
    }
    function product2_onclick(){
        config["current"] = 1006 + config["base"];
        change_state(config);
        choise["product2click"] = 1;
        choise["start_time"] = new Date();
        console.log("product2_onclick:", choise["start_time"])
    }
    function product3_onclick(){
        config["current"] = 1007 + config["base"];
        change_state(config);
        choise["product3_click"] = 1;
        choise["start_time"] = new Date();
        console.log("product3_onclick:", choise["start_time"])
    }
    function product4_onclick(){
        config["current"] = 1008 + config["base"];
        change_state(config);
        choise["product4_click"] = 1;
        choise["start_time"] = new Date();
        console.log("product4_onclick:", choise["start_time"])
    }

    //page3_1 初始化

    var choise = {
        "start_time": new Date(),
        "end_time": new Date(),
        "spend_time": 0,
        "product1": [],
        "product2": [],
        "product3": [],
        "product4": [],
        "product1_click":0,
        "product2_click":0,
        "product3_click":0,
        "product4_click":0,
        "tostring": function () {
            var str = this["start_time"].format("yyyy-MM-dd_hh:mm:ss") + " "
                    + this["end_time"].format("yyyy-MM-dd_hh:mm:ss") + " "
                    + Math.round(this["spend_time"] / 1000) + " "
            for(var i=0; i < this["product1"].length; i++) {
                var pathname = this["product1"][i][1];
                var index1 = pathname.lastIndexOf("/");
                var index2 = pathname.lastIndexOf(".");
                str = str + pathname.substring(index1+1,index2) + " " + this["product1"][i][0] + " ";
            }
            for(var i=0; i < this["product2"].length; i++) {
                var pathname = this["product2"][i][1];
                var index1 = pathname.lastIndexOf("/");
                var index2 = pathname.lastIndexOf(".");
                str = str + pathname.substring(index1+1,index2) + " " + this["product2"][i][0] + " ";
            }
            for(var i=0; i < this["product3"].length; i++) {
                var pathname = this["product3"][i][1];
                var index1 = pathname.lastIndexOf("/");
                var index2 = pathname.lastIndexOf(".");
                str = str + pathname.substring(index1+1,index2) + " " + this["product3"][i][0] + " ";
            }
            for(var i=0; i < this["product4"].length; i++) {
                var pathname = this["product4"][i][1];
                var index1 = pathname.lastIndexOf("/");
                var index2 = pathname.lastIndexOf(".");
                str = str + pathname.substring(index1+1,index2) + " " + this["product4"][i][0] + " ";
            }
            return str;
        }
    }

    var choise_strings = [];

    function left_init() {
        $("#left_green_tea").unbind();
        $("#left_green_tea").on("click", function () {
            choise["product1_click"] = 1;
            config["current"] = 1005 + config["base"];
            change_state(config);
        });
        $("#left_red_tea").unbind();
        $("#left_red_tea").on("click", function () {
            choise["product2_click"] = 1;
            config["current"] = 1006 + config["base"];
            change_state(config);
        });
        $("#left_qing_tea").unbind();
        $("#left_qing_tea").on("click", function () {
            choise["product3_click"] = 1;
            config["current"] = 1007 + config["base"];
            change_state(config);
        });
        $("#left_hua_tea").unbind();
        $("#left_hua_tea").on("click", function () {
            choise["product4_click"] = 1;
            config["current"] = 1008 + config["base"];
            change_state(config);
        });
    }
    function check_show_buy_button(current_choise_item){
        var show = false;
        var show_count = 0;
        for(var i=0;i<choise["product1"].length; i++){
            if(choise["product1"][i][0]){
                show_count++;
            }
        }
        for(var i=0;i<choise["product2"].length; i++){
            if(choise["product2"][i][0]){
                show_count++;
            }
        }
        for(var i=0;i<choise["product3"].length; i++){
            if(choise["product3"][i][0]){
                show_count++;
            }
        }
        for(var i=0;i<choise["product4"].length; i++){
            if(choise["product4"][i][0]){
                show_count++;
            }
        }

        var type_count = choise["product1_click"] + choise["product2_click"]+ choise["product3_click"]+choise["product4_click"];

        if(show_count>=5 || type_count>=4) {
            $("#buy_button").css("visibility","visible");
            $("#buy_button").unbind();
            $("#buy_button").on("click",function(){
                save_on_click(current_choise_item[1]);
            });
        }else{
            $("#buy_button").css("visibility","none");
            $("#buy_button").unbind();
            $("#buy_button").on("click",function(){});
        }


    }

    function choice_init(current_choise) {
        $("#choice_1").unbind();
        $("#choice_1").on("click", function () {
            choice_detail_display(current_choise[0]);
        });
        $("#choice_2").unbind();
        $("#choice_2").on("click", function () {
            choice_detail_display(current_choise[1]);
        });
        $("#choice_3").unbind();
        $("#choice_3").on("click", function () {
            choice_detail_display(current_choise[2]);
        });
        $("#choice_4").unbind();
        $("#choice_4").on("click", function () {
            choice_detail_display(current_choise[3]);
        });
        $("#choice_5").unbind();
        $("#choice_5").on("click", function () {
            choice_detail_display(current_choise[4]);
        });
    }
    
    function choice_detail_display(current_choice_item) {
        $("#tea_name").html(get_product_name(current_choice_item));
        $("#tea_assortment").html(get_product_attribute(current_choice_item));
        $("#other_discription").html(get_product_other_description(current_choice_item));
        $("#select_pic").attr("src", get_product_file_path(current_choice_item));
        $("#tea_benefit").html(get_product_benefit_description(current_choice_item));
        set_product_chosen(current_choice_item);
        check_show_buy_button(current_choice_item);
        $("#product_discription").css("visibility","visible");
    }

    function page_product1_after_init(){
        // 设置页面详细信息
        set_page_detail(choise["product1"]);
        // 四个标签按钮点击事件
        left_init();
        // 五个商品点击事件
        choice_init(choise["product1"]);
    }

    function page_product2_after_init(){
        // 设置页面详细信息
        set_page_detail(choise["product2"]);
        // 四个标签按钮点击事件
        left_init();
        // 五个商品点击事件
        choice_init(choise["product2"]);
    }

    function page_product3_after_init(){
        // 设置页面详细信息
        set_page_detail(choise["product3"]);
        // 四个标签按钮点击事件
        left_init();
        // 五个商品点击事件
        choice_init(choise["product3"]);
    }

    function page_product4_after_init(){
        // 设置页面详细信息
        set_page_detail(choise["product4"]);
        // 四个标签按钮点击事件
        left_init();
        // 五个商品点击事件
        choice_init(choise["product4"]);
    }

    function get_filename(filepath) {
        var index1 = filepath.lastIndexOf("/");
        var index2 = filepath.lastIndexOf(".");
        return filepath.substring(index1+1,index2);
    }

    function get_product_name(choice_item) {
        return get_filename(get_product_file_path(choice_item));
    }

    function set_product_chosen(choice_item) {
        choice_item[0] = 1;
    }
    
    function get_product_file_path(choice_item) {
        return choice_item[1];
    }

    function get_product_attribute(choice_item) {
        return choice_item[2];
    }

    function get_product_benefit(choice_item) {
        return choice_item[3];
    }

    function get_product_other_description(choice_item) {
        return choice_item[4];
    }

    function get_product_benefit_description(choice_item) {
        return choice_item[5];
    }

    function set_page_detail(choice) {
        // 设置标题
        var attribute = get_product_attribute(choice[0]);
        $("#assortment_title").html(attribute);
        if(title_color_map[attribute] != null){
            $("#assortment_title").css("color", title_color_map[attribute]);
        }

        // 设置名称
        $("#text_1").html(get_product_name(choice[0]));
        $("#text_2").html(get_product_name(choice[1]));
        $("#text_3").html(get_product_name(choice[2]));
        $("#text_4").html(get_product_name(choice[3]));
        $("#text_5").html(get_product_name(choice[4]));
        // 设置图片
        $("#pic_1").attr("src", get_product_file_path(choice[0]));
        $("#pic_2").attr("src", get_product_file_path(choice[1]));
        $("#pic_3").attr("src", get_product_file_path(choice[2]));
        $("#pic_4").attr("src", get_product_file_path(choice[3]));
        $("#pic_5").attr("src", get_product_file_path(choice[4]));
    }

    function random_choise_product(product_arr, num) {
        var product_index = Array.from(Array(product_arr.length).keys())
        shuffle(product_index);
        var product_chosen = [];
        for(var i=0; i<num; i++){
            product_chosen.push(product_arr[product_index[i]]);
        }
        return product_chosen;
    }

    function shuffle(a) {
        var len = a.length;
        for (var i = 0; i < len - 1; i++) {
            var index = parseInt(Math.random() * (len - i));
            var temp = a[index];
            a[index] = a[len - i - 1];
            a[len - i - 1] = temp;
        }
    }

    function save_on_click(final_choose) {
        console.log("save_in_click", final_choose);
        choise["end_time"] = new Date();
        choise["spend_time"] = choise["end_time"] - choise["start_time"];
        var string = product_config["name"] + " " + condition + " " + username + " " + get_filename(final_choose) + " "+ choise.tostring();
        console.log(string);
        choise_strings.push(string);

        config["current"] = 1009 + config["base"];
        change_state(config);


        console.log("choise_strings:")
        for(var i = 0; i < choise_strings.length; ++i){
            console.log(i+1, ":", choise_strings[i])
        }

    }

    
    // page question
    var answers = {
        "current_question":0,
        "ids":[],
        "answers":[]
    }
    var answer_id_strings = [];
    var answer_answer_strings = [];
    function show_current_question() {
        var index = answers["current_question"];
        if(index >= product_question["questions"].length){
            console.log("question end, index: ", index)
            answer_id_strings.push(product_config["name"] + " " + answers["ids"].join(" "));
            answer_answer_strings.push(product_config["name"] + " " + answers["answers"].join(" "));
            config["current"] = 1010 + config["base"];
            change_state(config);
            return;
        }
        var question = product_question["questions"][index];
        set_body(question["template"])
        $("#content").html(question["content"]);
        $("#left").html(question["left"]);
        $("#right").html(question["right"]);
        $("#next_page").unbind();
        $("#next_page").on("click",function () {
            var val=$('input:radio[name="one_choice"]:checked').val();
            if(val==null){
                console.log("question select nothing", question)
                alert("请至少选择一个选项");
                return;
            }
            answers["ids"].push(question["id"])
            answers["answers"].push(val)
            answers["current_question"] = index + 1;
            show_current_question();
        });
    }
    
    function page_question_after_init() {
        answers["current_question"] = 0;
        show_current_question();
    }

    // page phrase transition
    function page_phrase_transition_after_init() {
        $("#next_phrase").unbind();
        $("#next_phrase").on("click", function () {
            config["current"] = 1002 + config["base"] + 1000;
            change_state(config);
        });
    }

    // page final submit
    function page_final_submit_after_init() {
        $("#next_phrase").unbind();
        $("#next_phrase").on("click", function () {
            save_final_file();
        });
    }
    
    function save_final_file() {
        var filename = condition + "_" + choise["end_time"].format("yyyy_MM_dd_hh_mm") + "_" + username + ".txt";
        var stringObj = {"choise": choise_strings.sort(), "question_id": answer_id_strings.sort(), "question_answer": answer_answer_strings.sort()}
        var string = JSON.stringify(stringObj)
        console.log("final save:", string)
        saveFile(filename, string);
    }
    
    function clear_choice() {
        choise = {
            "start_time": new Date(),
            "end_time": new Date(),
            "spend_time": 0,
            "product1": [],
            "product2": [],
            "product3": [],
            "product4": [],
            "product1_click":0,
            "product2_click":0,
            "product3_click":0,
            "product4_click":0,
            "tostring": function () {
                var str = this["start_time"].format("yyyy-MM-dd_hh:mm:ss") + " "
                    + this["end_time"].format("yyyy-MM-dd_hh:mm:ss") + " "
                    + Math.round(this["spend_time"] / 1000) + " "
                for(var i=0; i < this["product1"].length; i++) {
                    var pathname = this["product1"][i][1];
                    var index1 = pathname.lastIndexOf("/");
                    var index2 = pathname.lastIndexOf(".");
                    str = str + pathname.substring(index1+1,index2) + " " + this["product1"][i][0] + " ";
                }
                for(var i=0; i < this["product2"].length; i++) {
                    var pathname = this["product2"][i][1];
                    var index1 = pathname.lastIndexOf("/");
                    var index2 = pathname.lastIndexOf(".");
                    str = str + pathname.substring(index1+1,index2) + " " + this["product2"][i][0] + " ";
                }
                for(var i=0; i < this["product3"].length; i++) {
                    var pathname = this["product3"][i][1];
                    var index1 = pathname.lastIndexOf("/");
                    var index2 = pathname.lastIndexOf(".");
                    str = str + pathname.substring(index1+1,index2) + " " + this["product3"][i][0] + " ";
                }
                for(var i=0; i < this["product4"].length; i++) {
                    var pathname = this["product4"][i][1];
                    var index1 = pathname.lastIndexOf("/");
                    var index2 = pathname.lastIndexOf(".");
                    str = str + pathname.substring(index1+1,index2) + " " + this["product4"][i][0] + " ";
                }
                return str;
            }
        }

        answers = {
            "current_question":0,
            "ids":[],
            "answers":[]
        }
    }

    function main() {
        print_config(config);
        register_key_event(config);
        change_state(config);
        window.setInterval(working_machine, 10, config);
        window.setInterval(check_and_show_next, 10, config);
    }


    main();


</script>

</html>