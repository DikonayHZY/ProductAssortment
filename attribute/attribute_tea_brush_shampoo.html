<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Study1</title>
    <script type="text/javascript" src="template_2.js"></script>
    <script type="text/javascript" src="template_4.js"></script>
    <script type="text/javascript" src="template_5.js"></script>
    <script type="text/javascript" src="template_7.js"></script>
    <script type="text/javascript" src="template_9.js"></script>
    <script type="text/javascript" src="template_10.js"></script>
    <script type="text/javascript" src="page_test.js"></script>
    <script type="text/javascript" src="template_TF1.js"></script>
    <script type="text/javascript" src="template_TF2.js"></script>
    <script type="text/javascript">
        
        var username = "黄梓仪";
        var gender = "0";
        var age = "18";
        var major = "应用化学";
        var grade = "大一";
        var phone = "空";
        var purpose = "空";
        var condition = "attribute";            // "attribute"
        var order_number = 1;                   // 默认配置后面会改: 如果配置>0则强制指定, 否则根据url最后的数字指定, 如 xxx_2.html => order_number = 2
        var order_sign = "tea_shampoo_brush";   // 跟随 order_number 修改

        console.log("order:", order_number);
        console.log("condition:", condition);

        var title_color_map = {
            "绿茶": "#90A71F",
            "红茶": "#CA6931",
            "青茶": "#B27511",
            "花茶": "#CE6E60",
        }

	    var config_tea = {
            "name": "tea",
	        "product1":[
	            [0, "../resource/tea/雪水云绿.JPG", "绿茶", "美容养颜", "银剑出鞘，茸毫隐翠，林间香气","延缓衰老，防癌抗癌"],
	            [0, "../resource/tea/休宁松萝.JPG", "绿茶", "舒缓压力", "紧卷匀壮，色泽绿润，橄榄风味","提神醒脑，清心明目"],
	            [0, "../resource/tea/信阳毛尖.JPG", "绿茶", "减肥瘦身", "匀整细直，白毫隐翠，有熟果香","消脂减脂，净化肠胃"],
	            [0, "../resource/tea/西湖龙井.JPG", "绿茶", "保健养生", "扁而平直，绿中透黄，有炒豆香","降低血脂，防癌抗癌，抗菌消炎"],
	            [0, "../resource/tea/太平猴魁.JPG", "绿茶", "舒缓压力", "两叶抱芽，绿中隐红，兰香高爽","促进血液循环，松弛平滑肌"],
//	            [0, "../resource/tea/千岛玉叶.JPG", "绿茶", "美容养颜", "扁平挺直，翠绿嫩黄，兰蕙之清","抗老，防癌，养颜，抗菌"],
//	            [0, "../resource/tea/蒙顶甘露.JPG", "绿茶", "舒缓压力", "紧凑多毫，浅绿油润，香气馥郁","好喝，身心愉悦"],
//	            [0, "../resource/tea/梅尖银毫.JPG", "绿茶", "美容养颜", "紧细圆直，翠绿显毫，香气浓郁","抗氧化，养颜健身"],
//	            [0, "../resource/tea/庐山云雾茶.JPG", "绿茶", "减肥瘦身", "条索紧结，青翠多毫，有板栗香","消脂减脂，减肥瘦身"],
//	            [0, "../resource/tea/六安瓜片.JPG", "绿茶", "减肥瘦身", "瓜子形单叶，叶底嫩黄，熟栗香味","降低血脂，促进消化"],
//	            [0, "../resource/tea/莲心绿茶.JPG", "绿茶", "保健养生", "芽叶成朵，色泽黄绿，绿豆香气","抵御放射性元素，防治坏血病"],
//	            [0, "../resource/tea/开化龙顶.JPG", "绿茶", "保健养生","紧直挺秀，银绿翠隐，淡青草味","清热解毒，固齿防龋"],
//	            [0, "../resource/tea/径山茶.JPG", "绿茶", "美容养颜","纤细微曲，色泽绿翠，板栗香味","排毒养颜，抗氧化"],
//	            [0, "../resource/tea/黄山毛峰.JPG", "绿茶", "保健养生","细扁微卷，银毫显露，香气如兰","利尿消肿，防癌抗癌，固齿防龋"],
//	            [0, "../resource/tea/狗牯脑茶.JPG", "绿茶", "保健养生","紧结微勾，黛绿莹润，清心雅郁","利尿解毒，防治心血管疾病"],
//	            [0, "../resource/tea/碧螺春.JPG", "绿茶", "保健养生","形状如螺，白毫隐翠，清香淡雅","提神解乏，抗菌消炎"],
	        ],
	        "product2":[
	            [0, "../resource/tea/政和工夫.JPG", "红茶", "舒缓压力", "条索重实，毫尖金黄，紫罗兰香", "好喝，身心愉悦"],
	            [0, "../resource/tea/正山小种.JPG", "红茶", "保健养生", "条索肥壮，呈红褐色，有松烟香", "利尿排毒，强壮骨骼，护心养胃"],
	            [0, "../resource/tea/英红.JPG", "红茶", "舒缓压力", "外形重实，色泽乌润，香气浓郁", "好喝，身心愉悦"],
	            [0, "../resource/tea/银骏眉.JPG", "红茶", "舒缓压力", "条索紧细，乌润带金，花果清香", "好喝，身心愉悦"],
	            [0, "../resource/tea/宜红.JPG", "红茶", "舒缓压力", "条索紧细，略带金毫，花果清香", "好喝，身心愉悦"],
//	            [0, "../resource/tea/信阳红.JPG", "红茶", "保健养生", "条索匀整，乌黑披金，有花果香", "消炎杀菌，利尿解毒"],
//	            [0, "../resource/tea/坦洋工夫.JPG", "红茶", "减肥瘦身", "条索紧细，毫尖金黄，桂圆香气", "减肥瘦身，养胃护胃"],
//	            [0, "../resource/tea/祁门红茶.JPG", "红茶", "保健养生", "条索紧细，色泽乌润，兰果香气", "防治心血管疾病，清凉消暑"],
//	            [0, "../resource/tea/宁红.JPG", "红茶", "舒缓压力", "紧结圆直，略显红筋，鲜香持久", "好喝，身心愉悦"],
//	            [0, "../resource/tea/荔枝红.JPG", "红茶", "舒缓压力", "条索纤秀，乌黑油润，香气清幽", "风味独特，好喝"],
//	            [0, "../resource/tea/九曲红梅.JPG", "红茶", "舒缓压力", "细若发丝，金色绒毛，似蜜糖香", "好喝，身心愉悦"],
//	            [0, "../resource/tea/金骏眉.JPG", "红茶", "舒缓压力", "细瘦卷曲，乌中透金，烤红薯香", "好喝，身心愉悦"],
//	            [0, "../resource/tea/滇红.JPG", "红茶", "舒缓压力", "紧结肥壮，色泽乌润，香气鲜锐", "好喝，身心愉悦"],
//	            [0, "../resource/tea/川红.JPG", "红茶", "舒缓压力", "紧细圆直，色泽乌润，带枯糖香", "好喝，身心愉悦"],
	        ],
	        "product3":[
	            [0, "../resource/tea/永春佛手.JPG", "青茶", "舒缓压力","紧结肥壮，砂率乌润，香气悠长", "好喝，身心愉悦"],
	            [0, "../resource/tea/武夷水仙.JPG", "青茶", "舒缓压力","叶端扭曲，油润暗绿，兰花香郁", "好喝，身心愉悦"],
	            [0, "../resource/tea/武夷肉桂.JPG", "青茶", "美容养颜","匀整卷曲，褐绿油润，桂皮香味", "改善皮肤敏感溃烂，延缓衰老"],
	            [0, "../resource/tea/武夷大红袍.JPG", "青茶", "美容养颜","条索紧结，绿褐鲜润，有兰花香", "美白抗氧化，醒酒敌烟"],
	            [0, "../resource/tea/铁罗汉.JPG", "青茶", "舒缓压力","条索匀整，褐绿鲜润， 兰香馥郁", "耐泡，好喝"],
//	            [0, "../resource/tea/水金龟.JPG", "青茶", "舒缓压力","条索紧结，色泽青褐，清雅高长", "好喝，身心愉悦"],
//	            [0, "../resource/tea/高山乌龙.JPG", "青茶", "舒缓压力","半球形状，色泽深绿，花香突出", "好喝，身心愉悦"],
//	            [0, "../resource/tea/凤凰水仙.JPG", "青茶", "舒缓压力","挺直肥大，鳝鱼皮色，天然花香", "清热解暑，生津止渴"],
//	            [0, "../resource/tea/凤凰单枞.JPG", "青茶", "美容养颜","条索匀直，黄褐油润，独特花香", "改善皮肤过敏，养颜促代谢"],
//	            [0, "../resource/tea/冻顶乌龙.JPG", "青茶", "减肥瘦身","呈半球形，色泽墨绿，有桂花香", "消脂减肥，抗氧化"],
//	            [0, "../resource/tea/东方美人.JPG", "青茶", "减肥瘦身","茶心肥厚，满披茸毛，有熟果香", "消脂减肥，降低血脂"],
//	            [0, "../resource/tea/白芽奇兰.JPG", "青茶", "舒缓压力","紧结匀整，翠绿油润，兰花香味", "好喝，身心愉悦"],
//	            [0, "../resource/tea/白鸡冠.JPG", "青茶", "舒缓压力","条索紧结，色泽灰暗，香气悠长", "清心明目，提神解乏"],
//	            [0, "../resource/tea/安溪铁观音.JPG", "青茶", "美容养颜","卷曲圆结，色泽砂绿，有兰花香", "抗氧化，防治龋齿"],
//	            [0, "../resource/tea/阿里山乌龙.JPG", "青茶", "舒缓压力","呈半球形，色泽砂绿，清新典雅", "好喝，身心愉悦"],
	        ],
	        "product4":[
	            [0, "../resource/tea/茉莉花茶.JPG", "花茶", "舒缓压力","紧细圆整，黄中带褐，灵香持久", "好喝，身心愉悦"],
	            [0, "../resource/tea/玫瑰花茶.JPG", "花茶", "减肥瘦身","朵大饱满，色泽均匀，香味清淡", "消脂减肥，促进消化"],
	            [0, "../resource/tea/苦丁茶.JPG", "花茶", "减肥瘦身","条索紧结，灰绿相间，清香带苦", "降压降脂，清热消暑"],
	            [0, "../resource/tea/黄山贡菊.JPG", "花茶", "美容养颜","朵大均匀，色白蒂绿，菊花香味", "护肤美容，排毒护肝"],
	            [0, "../resource/tea/杭白菊.JPG", "花茶", "保健养生","花形完整，嫩黄鲜亮，香气清冽", "清热解毒，消食醒酒"],
	        ],
	    };

        var choose_tea =  {
            "current": 0,
            "names": [
                "雪水云绿",
//                "正山小种",
//                "武夷肉桂",
//                "黄山贡菊",
            ]
        };

	    var question_tea = {
            "questions":[
                {"id":"tea1", "template": template_2, "content":"绿茶绿茶？", "left": "是", "right": "不是"},
                {"id":"tea2", "template": template_9, "content":"李明正在考虑周末去拜访一个朋友。他去拜访的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"tea3", "template": template_9, "content":"小红正在考虑给自己买一双新鞋。她买的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"tea4", "template": template_9, "content":"小张正在查看他的邮件。他收到垃圾邮件的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"tea5", "template": template_9, "content":"小郭正在考虑是否要养一只宠物。他养宠物可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"tea6", "template": template_9, "content":"小杨正在参加公司年会的抽奖活动。他抽中大奖可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"tea7", "template": template_7, "content":"总的来说，你认为御茗阁茶叶目录中的茶叶之间有多相似？", "left": "完全不相似", "right": "非常相似"},
//                {"id":"tea8", "template": template_9, "content":"御茗阁为我提供了多样化的选择", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"tea9", "template": template_9, "content":"在完成选择任务之时, 我感觉有较多的可选产品", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"tea10", "template": template_4, "content":"我感觉难以挑选出自己偏好的一款茶叶", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"tea11", "template": template_4, "content":"我感觉完成茶叶选择的任务是困难的", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"tea12", "template": template_4, "content":"我感觉完成茶叶选择的任务需要耗费精力", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"tea13", "template": template_4, "content":"我感觉完成茶叶选择的任务需要进行较多的思考", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"tea14", "template": template_4, "content":"我感觉完成茶叶选择的任务需要花费了较长的时间", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"tea15", "template": template_4, "content":"我了解御茗阁这个品牌", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"tea16", "template": template_4, "content":"我了解茶叶知识", "left": "非常不赞同", "right": "非常赞同"},
            ],
        };

	    var test_tea = {
            // 问卷的第一张控件, 图片: TF_pic1, 名称 TF_name1, TF_benefit1, TF_attribute1,
            "tests":[
                [
                    {"id":"tea_test1", "template": template_TF1, "content":"茶叶茶叶1-1？--1正确", "left": "左边", "right": "右边", "true":"1",
                        "pictures":[
                            {"src":"../resource/tea/武夷大红袍.JPG", "name":"武夷大红袍", "benefit":"美容养颜", "attribute":"青茶"},
                        ],
                    },
                    {"id":"tea_test2", "template": template_TF1, "content":"茶叶茶叶1-2？--2正确", "left": "", "right": "", "true":"2",
                        "pictures":[
                            {"src":"../resource/tea/铁罗汉.JPG", "name":"铁罗汉", "benefit":"舒缓压力", "attribute":"青茶"},
                        ],
                    },
                ],
                [
                    {"id":"tea_test3", "template": template_TF2, "content":"茶叶茶叶2-1？--1正确", "left": "左左", "right": "右右", "true":"1",
                        "pictures":[
                            {"src":"../resource/tea/雪水云绿.JPG", "name":"雪水云绿", "benefit":"美容养颜", "attribute":"绿茶"},
                            {"src":"../resource/tea/杭白菊.JPG", "name":"杭白菊", "benefit":"保健养生", "attribute":"花茶"},
                        ],
                    },
                    {"id":"tea_test4", "template": template_TF2, "content":"茶叶茶叶2-2？--2正确", "left": "", "right": "", "true":"2",
                        "pictures":[
                            {"src":"../resource/tea/政和工夫.JPG", "name":"政和工夫", "benefit":"舒缓压力", "attribute":"红茶"},
                            {"src":"../resource/tea/银骏眉.JPG", "name":"银骏眉", "benefit":"保健养生", "attribute":"红茶"},
                        ],
                    },
                ],
            ],
        };


        var config_shampoo = {
            "name": "shampoo",
            "product1":[
                [0, "../resource/shampoo/ALTERNA-PB.png", "白松露", "强效修护", "不含硅油，无防腐剂添加，不含硫酸盐","延缓衰老，防癌抗癌"],
                [0, "../resource/shampoo/ALTERNA-PS.png", "白松露", "丝滑水润", "不含硅油，无防腐剂添加，不含硫酸盐","提神醒脑，清心明目"],
                [0, "../resource/shampoo/ALTERNA-PD.png", "白松露", "清爽控油", "不含硅油，无防腐剂添加，不含硫酸盐","消脂减脂，净化肠胃"],
                [0, "../resource/shampoo/ALTERNA-PJ.png", "白松露", "防晒锁色", "不含硅油，无防腐剂添加，不含硫酸盐","降低血脂，防癌抗癌，抗菌消炎"],
                [0, "../resource/shampoo/ALTERNA-PG.png", "白松露", "丝滑水润", "不含硅油，无防腐剂添加，不含硫酸盐","促进血液循环，松弛平滑肌"],
//                [0, "../resource/shampoo/ALTERNA-PH.png", "白松露", "清爽控油", "不含硅油，无防腐剂添加，不含硫酸盐","抗老，防癌，养颜，抗菌"],
            ],

            "product2":[
                [0, "../resource/shampoo/ALTERNA-VB.png", "鱼子酱", "强效修护", "不含硅油，无防腐剂添加，不含硫酸盐", "好喝，身心愉悦"],
                [0, "../resource/shampoo/ALTERNA-VS.png", "鱼子酱", "丝滑水润", "不含硅油，无防腐剂添加，不含硫酸盐", "利尿排毒，强壮骨骼，护心养胃"],
                [0, "../resource/shampoo/ALTERNA-VD.png", "鱼子酱", "清爽控油", "不含硅油，无防腐剂添加，不含硫酸盐", "好喝，身心愉悦"],
                [0, "../resource/shampoo/ALTERNA-VJ.png", "鱼子酱", "防晒锁色", "不含硅油，无防腐剂添加，不含硫酸盐", "好喝，身心愉悦"],
                [0, "../resource/shampoo/ALTERNA-VG.png", "鱼子酱", "防晒锁色", "不含硅油，无防腐剂添加，不含硫酸盐", "好喝，身心愉悦"],
//                [0, "../resource/shampoo/ALTERNA-VH.png", "鱼子酱", "强效修护", "不含硅油，无防腐剂添加，不含硫酸盐", "消炎杀菌，利尿解毒"],


            ],
            "product3":[
                [0, "../resource/shampoo/ALTERNA-ZB.png", "牛油果", "强效修护","不含硅油，无防腐剂添加，不含硫酸盐", "好喝，身心愉悦"],
                [0, "../resource/shampoo/ALTERNA-ZS.png", "牛油果", "丝滑水润","不含硅油，无防腐剂添加，不含硫酸盐", "好喝，身心愉悦"],
                [0, "../resource/shampoo/ALTERNA-ZD.png", "牛油果", "清爽控油","不含硅油，无防腐剂添加，不含硫酸盐", "改善皮肤敏感溃烂，延缓衰老"],
                [0, "../resource/shampoo/ALTERNA-ZJ.png", "牛油果", "防晒锁色","不含硅油，无防腐剂添加，不含硫酸盐", "美白抗氧化，醒酒敌烟"],
                [0, "../resource/shampoo/ALTERNA-ZG.png", "牛油果", "丝滑水润","不含硅油，无防腐剂添加，不含硫酸盐", "耐泡，好喝"],
//                [0, "../resource/shampoo/ALTERNA-ZH.png", "牛油果", "强效修护","不含硅油，无防腐剂添加，不含硫酸盐", "好喝，身心愉悦"],

            ],
            "product4":[
                [0, "../resource/shampoo/ALTERNA-TB.png", "北欧木", "强效修护","不含硅油，无防腐剂添加，不含硫酸盐", "好喝，身心愉悦"],
                [0, "../resource/shampoo/ALTERNA-TS.png", "北欧木", "丝滑水润","不含硅油，无防腐剂添加，不含硫酸盐", "消脂减肥，促进消化"],
                [0, "../resource/shampoo/ALTERNA-TD.png", "北欧木", "清爽控油","不含硅油，无防腐剂添加，不含硫酸盐", "降压降脂，清热消暑"],
                [0, "../resource/shampoo/ALTERNA-TJ.png", "北欧木", "防晒锁色","不含硅油，无防腐剂添加，不含硫酸盐", "护肤美容，排毒护肝"],
                [0, "../resource/shampoo/ALTERNA-TG.png", "北欧木", "防晒锁色","不含硅油，无防腐剂添加，不含硫酸盐", "清热解毒，消食醒酒"],
//                [0, "../resource/shampoo/ALTERNA-TH.png", "北欧木", "清爽控油","不含硅油，无防腐剂添加，不含硫酸盐", "清热解毒，消食醒酒"],
//                [0, "../resource/shampoo/ALTERNA-TN.png", "北欧木", "丝滑水润","不含硅油，无防腐剂添加，不含硫酸盐", "清热解毒，消食醒酒"],
            ],
        };

        var choose_shampoo =  {
            "current": 0,
            "names": [
                "ALTERNA-PS",
//                "ALTERNA-VB",
//                "ALTERNA-ZB",
//                "ALTERNA-TG",
            ]
        };


        var question_shampoo = {
            "questions":[
                {"id":"shampoo1", "template": template_2, "content":"1洗发水洗发水？", "left": "是111", "right": "不是111"},
                {"id":"shampoo2", "template": template_9, "content":"小王正在考虑是否参加一个美食烹饪培训课。他报名的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"shampoo3", "template": template_9, "content":"小李正在考虑买一台新笔记本电脑。他买的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"shampoo4", "template": template_9, "content":"小陈正在等高铁。这趟高铁晚点的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"shampoo5", "template": template_9, "content":"小张打算去超市买洗衣液。这件商品降价的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"shampoo6", "template": template_9, "content":"小刘每天开车去上班。她的车被撞凹的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"shampoo7", "template": template_7, "content":"总的来说，你认为ALTERNA提供的这些洗发水产品之间有多相似？", "left": "完全不相似", "right": "非常相似"},
//                {"id":"shampoo8", "template": template_9, "content":"ALTERNA为我提供了多样化的选择", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"shampoo9", "template": template_9, "content":"在完成选择任务之时, 我感觉有较多的可选产品", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"shampoo10", "template": template_4, "content":"我感觉难以挑选出自己偏好的一款洗发水", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"shampoo11", "template": template_4, "content":"我感觉完成洗发水选择的任务是困难的", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"shampoo12", "template": template_4, "content":"我感觉完成洗发水选择的任务需要耗费精力", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"shampoo13", "template": template_4, "content":"我感觉完成洗发水选择的任务需要进行较多的思考", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"shampoo14", "template": template_4, "content":"我感觉完成洗发水选择的任务需要花费了较长的时间", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"shampoo15", "template": template_4, "content":"我了解ALTERNA这个品牌", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"shampoo16", "template": template_4, "content":"我了解洗发水知识", "left": "非常不赞同", "right": "非常赞同"},
            ],
        };

        var test_shampoo = {
            // 问卷的第一张控件, 图片: TF_pic1, 名称 TF_name1, TF_benefit1, TF_attribute1,
            "tests":[
                [
                    {"id":"shampoo_test1", "template": template_TF1, "content":"香水香水1-1？--2正确", "left": "", "right": "", "true":"2",
                        "pictures":[
                            {"src":"../resource/shampoo/ALTERNA-PB.png", "name":"ALTERNA-PB", "benefit":"强效修护", "attribute":"白松露"},
                        ],
                    },
                ],
                [
                    {"id":"shampoo_test2", "template": template_TF2, "content":"香水香水2-1？--2正确", "left": "", "right": "", "true":"2",
                        "pictures":[
                            {"src":"../resource/shampoo/ALTERNA-TB.png", "name":"ALTERNA-TB", "benefit":"强效修护", "attribute":"北欧木"},
                            {"src":"../resource/shampoo/ALTERNA-TS.png", "name":"ALTERNA-TS", "benefit":"丝滑水润", "attribute":"北欧木"},
                        ],
                    },
                ],
            ],
        };


        var config_brush = {
            "name": "bursh",
            "product1":[
                [0, "../resource/brush/P3216_01.png", "机械转动型", "健康清洁", "个性化辅导，精锐感知科技，智能刷头感应","延缓衰老，防癌抗癌"],
                [0, "../resource/brush/P3216_13.png", "机械转动型", "抗敏护龈", "个性化辅导，精锐感知科技，智能刷头感应","提神醒脑，清心明目"],
                [0, "../resource/brush/P3216_31.png", "机械转动型", "杀菌祛斑", "个性化辅导，精锐感知科技，智能刷头感应","消脂减脂，净化肠胃"],
                [0, "../resource/brush/P3226_22.png", "机械转动型", "深层美白", "个性化辅导，精锐感知科技，智能刷头感应","降低血脂，防癌抗癌，抗菌消炎"],
                [0, "../resource/brush/P3226_41.png", "机械转动型", "健康清洁", "个性化辅导，精锐感知科技，智能刷头感应","促进血液循环，松弛平滑肌"],
//                [0, "../resource/brush/P3226_51.png", "机械转动型", "杀菌祛斑", "个性化辅导，精锐感知科技，智能刷头感应","抗老，防癌，养颜，抗菌"],

            ],
            "product2":[
                [0, "../resource/brush/P6211_46.png", "声波振动型", "健康清洁", "个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],
                [0, "../resource/brush/P6215_29.png", "声波振动型", "抗敏护龈", "个性化辅导，精锐感知科技，智能刷头感应", "利尿排毒，强壮骨骼，护心养胃"],
                [0, "../resource/brush/P6225_16.png", "声波振动型", "杀菌祛斑", "个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],
                [0, "../resource/brush/P6263_62.png", "声波振动型", "深层美白", "个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],
                [0, "../resource/brush/P6275_63.png", "声波振动型", "健康清洁", "个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],
//                [0, "../resource/brush/P6712_04.png", "声波振动型", "抗敏护龈", "个性化辅导，精锐感知科技，智能刷头感应", "消炎杀菌，利尿解毒"],
//                [0, "../resource/brush/P6721_33.png", "声波振动型", "杀菌祛斑", "个性化辅导，精锐感知科技，智能刷头感应", "减肥瘦身，养胃护胃"],
//                [0, "../resource/brush/P6730_02.png", "声波振动型", "深层美白", "个性化辅导，精锐感知科技，智能刷头感应", "防治心血管疾病，清凉消暑"],
//                [0, "../resource/brush/P6761_03.png", "声波振动型", "抗敏护龈", "个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],

            ],
            "product3":[
                [0, "../resource/brush/P6809_02.png", "超声波型", "健康清洁","个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],
                [0, "../resource/brush/P6851_59.png", "超声波型", "抗敏护龈","个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],
                [0, "../resource/brush/P6855_12.png", "超声波型", "杀菌祛斑","个性化辅导，精锐感知科技，智能刷头感应", "改善皮肤敏感溃烂，延缓衰老"],
                [0, "../resource/brush/P6857_20.png", "超声波型", "深层美白","个性化辅导，精锐感知科技，智能刷头感应", "美白抗氧化，醒酒敌烟"],
                [0, "../resource/brush/P6859_12.png", "超声波型", "健康清洁","个性化辅导，精锐感知科技，智能刷头感应", "耐泡，好喝"],
//                [0, "../resource/brush/P6877_27.png", "超声波型", "抗敏护龈","个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],
//                [0, "../resource/brush/P6921_01.png", "超声波型", "杀菌祛斑","个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],
//                [0, "../resource/brush/P6972_10.png", "超声波型", "深层美白","个性化辅导，精锐感知科技，智能刷头感应", "清热解暑，生津止渴"],

            ],
            "product4":[
                [0, "../resource/brush/P8880_68.png", "电动喷雾型", "健康清洁","个性化辅导，精锐感知科技，智能刷头感应", "好喝，身心愉悦"],
                [0, "../resource/brush/P8911_03.png", "电动喷雾型", "抗敏护龈","个性化辅导，精锐感知科技，智能刷头感应", "消脂减肥，促进消化"],
                [0, "../resource/brush/P8962_05.png", "电动喷雾型", "杀菌祛斑","个性化辅导，精锐感知科技，智能刷头感应", "降压降脂，清热消暑"],
                [0, "../resource/brush/P9172_19.png", "电动喷雾型", "深层美白","个性化辅导，精锐感知科技，智能刷头感应", "护肤美容，排毒护肝"],
                [0, "../resource/brush/P9322_14.png", "电动喷雾型", "健康清洁","个性化辅导，精锐感知科技，智能刷头感应", "清热解毒，消食醒酒"],
//                [0, "../resource/brush/P9351_52.png", "电动喷雾型", "抗敏护龈","个性化辅导，精锐感知科技，智能刷头感应", "清热解毒，消食醒酒"],
//                [0, "../resource/brush/P9901_33.png", "电动喷雾型", "杀菌祛斑","个性化辅导，精锐感知科技，智能刷头感应", "清热解毒，消食醒酒"],
//                [0, "../resource/brush/P9903_42.png", "电动喷雾型", "深层美白","个性化辅导，精锐感知科技，智能刷头感应", "清热解毒，消食醒酒"],
//                [0, "../resource/brush/P9924_12.png", "电动喷雾型", "抗敏护龈","个性化辅导，精锐感知科技，智能刷头感应", "清热解毒，消食醒酒"],
//                [0, "../resource/brush/P9924_22.png", "电动喷雾型", "健康清洁","个性化辅导，精锐感知科技，智能刷头感应", "清热解毒，消食醒酒"],
            ],
        };

        var choose_brush =  {
            "current": 0,
            "names": [
                "P3216_01",
//                "P6215_29",
//                "P6859_12",
//                "P9172_19",
            ]
        };


        var question_brush = {
            "questions":[
                {"id":"brush0", "template": template_2, "content":"牙刷牙刷？", "left": "是", "right": "不是"},
                {"id":"brush1", "template": template_9, "content":"小兰主修哲学，正在考虑上法律学院。她申请的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"brush2", "template": template_9, "content":"小凡正在决定要不要举办一个新居乔迁宴会。她举办的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"brush3", "template": template_9, "content":"小王打算进行一次全国公路越野旅行。他途中遇到老乡的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"brush4", "template": template_9, "content":"小陈下周六有一门辅修课，该次上课老师点名的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"brush5", "template": template_9, "content":"小杨走进一家服装店。他购买的可能性有多大？", "left": "非常不可能", "right": "非常可能"},
//                {"id":"brush6", "template": template_7, "content":"总的来说，你认为GOVINO提供的这些电动牙刷之间有多相似？", "left": "完全不相似", "right": "非常相似"},
//                {"id":"brush7", "template": template_9, "content":"GOVINO为我提供了多样化的选择", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"brush8", "template": template_9, "content":"在完成选择任务之时, 我感觉有较多的可选产品", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"brush9", "template": template_4, "content":"我感觉难以挑选出自己偏好的一款电动牙刷", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"brush10", "template": template_4, "content":"我感觉完成电动牙刷选择的任务是困难的", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"brush11", "template": template_4, "content":"我感觉完成电动牙刷选择的任务需要耗费精力", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"brush12", "template": template_4, "content":"我感觉完成电动牙刷选择的任务需要进行较多的思考", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"brush13", "template": template_4, "content":"我感觉完成电动牙刷选择的任务需要花费了较长的时间", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"brush14", "template": template_4, "content":"我了解GOVINO这个品牌", "left": "非常不赞同", "right": "非常赞同"},
//                {"id":"brush15", "template": template_4, "content":"我了解GOVINO知识", "left": "非常不赞同", "right": "非常赞同"},
            ],

        };

        var test_brush = {
            // 问卷的第一张控件, 图片: TF_pic1, 名称 TF_name1, TF_benefit1, TF_attribute1,
            "tests":[
                [
                    {"id":"tea_brush1", "template": template_TF1, "content":"牙刷牙刷1-1？--1正确", "left": "左边", "right": "右边", "true":"1",
                        "pictures":[
                            {"src":"../resource/brush/P3216_01.png", "name":"P3216_01", "benefit":"健康清洁", "attribute":"机械转动型"},
                        ],
                    },
                ],
                [
                    {"id":"tea_brush2", "template": template_TF2, "content":"牙刷牙刷2-1？--2正确", "left": "左左", "right": "右右", "true":"1",
                        "pictures":[
                            {"src":"../resource/brush/P8880_68.png", "name":"P8880_68", "benefit":"健康清洁", "attribute":"电动喷雾型"},
                            {"src":"../resource/brush/P8911_03.png", "name":"P8911_03", "benefit":"抗敏护龈", "attribute":"电动喷雾型"},
                        ],
                    },
                    {"id":"tea_brush3", "template": template_TF2, "content":"牙刷牙刷2-2？--2正确", "left": "", "right": "", "true":"2",
                        "pictures":[
                            {"src":"../resource/brush/P6857_20.png", "name":"P6857_20", "benefit":"深层美白", "attribute":"超声波型"},
                            {"src":"../resource/brush/P6859_12.png", "name":"P6859_12", "benefit":"健康清洁", "attribute":"超声波型"},
                        ],
                    },
                    {"id":"tea_brush3", "template": template_TF2, "content":"牙刷牙刷2-3？--1正确", "left": "", "right": "", "true":"1",
                        "pictures":[
                            {"src":"../resource/brush/P8962_05.png", "name":"P8962_05", "benefit":"杀菌祛斑", "attribute":"电动喷雾型"},
                            {"src":"../resource/brush/P9172_19.png", "name":"P9172_19", "benefit":"深层美白", "attribute":"电动喷雾型"},
                        ],
                    },
                ],
            ],
        };
        

        var product_config = config_tea;
        var product_question = question_tea;
        var product_choose = choose_tea;
        var product_test = test_tea;


    </script>
    <script type="text/javascript" src="../common/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="../common/FileSaver.js"></script>
    <script type="text/javascript" src="page_introduction.js"></script>

    <script type="text/javascript" src="page_teach_preview.js"></script>
    <script type="text/javascript" src="page_teach_menu.js"></script>
    <script type="text/javascript" src="page_teach_product.js"></script>
    <script type="text/javascript" src="page_teach_transition.js"></script>

    <script type="text/javascript" src="page_choose_preview.js"></script>

    <script type="text/javascript" src="page_tea_introduction.js"></script>
    <script type="text/javascript" src="page_tea_task.js"></script>
    <script type="text/javascript" src="page_tea_menu.js"></script>
    <script type="text/javascript" src="page_tea_product.js"></script>
    <script type="text/javascript" src="page_tea_choose_menu.js"></script>
    <script type="text/javascript" src="page_tea_choose_product.js"></script>

    <script type="text/javascript" src="page_shampoo_introduction.js"></script>
    <script type="text/javascript" src="page_shampoo_task.js"></script>
    <script type="text/javascript" src="page_shampoo_menu.js"></script>
    <script type="text/javascript" src="page_shampoo_product.js"></script>
    <script type="text/javascript" src="page_shampoo_choose_menu.js"></script>
    <script type="text/javascript" src="page_shampoo_choose_product.js"></script>

    <script type="text/javascript" src="page_brush_introduction.js"></script>
    <script type="text/javascript" src="page_brush_task.js"></script>
    <script type="text/javascript" src="page_brush_menu.js"></script>
    <script type="text/javascript" src="page_brush_product.js"></script>
    <script type="text/javascript" src="page_brush_choose_menu.js"></script>
    <script type="text/javascript" src="page_brush_choose_product.js"></script>

    <script type="text/javascript" src="page_question.js"></script>
    <script type="text/javascript" src="page_phrase_transition.js"></script>
    <script type="text/javascript" src="page_final_submit.js"></script>


    <style>
        body, div, ul, li, a, p, span, select, input, option {
            margin: 0;
            padding: 0;
            font-family: "Microsoft Yahei";
            text-align: justify;
        }

         body, div, ul, li, a, p, span {
             border: 0;         
         }
       

        a {
            text-decoration: none;
        }

        .shampoo_main_menu a:link, .shampoo_main_menu a:visited {
            color:#FFFFFF; 
        }
        .shampoo_main_menu a:hover, .shampoo_main_menu a:active {
            color:#808080; 
        }

        .shampoo_main_menu .line {
            font-size: 50px; 
            font-weight: 100; 
            font-family: "NSimSun";
        }

        .shampoo_left_menu a{
            font-size: 30px;
        }

        .shampoo_left_menu a:link, .shampoo_left_menu a:visited {
            color: #262626; 
        }
        .shampoo_left_menu a:hover, .shampoo_left_menu a:active {
            color: #999999; 
        }

        a:link, a:visited {
            color: black; 
        }
        a:hover, a:active {
            color: #999999; 
        }


        .brush_main_menu a:link, .brush_main_menu a:visited {
            color:#000000; 
        }
        .brush_main_menu a:hover, .brush_main_menu a:active {
            color:#005a8e; 
        }

        .brush_main_menu .line {
            font-size: 50px; 
            font-weight: 100; 
            font-family: "NSimSun";
            color: #89827b;
        }

        .brush_left_menu a{
            font-size: 30px;
        }

        .brush_left_menu a:link, .brush_left_menu a:visited {
            color: #262626; 
        }
        .brush_left_menu a:hover, .brush_left_menu a:active {
            color: #999999; 
        }

        a:link, a:visited {
            color: black; 
        }
        a:hover, a:active {
            color: #999999; 
        }

        #tea_main_menu li {
            float: left;
        }

        #tea_main_menu li a {
            display:block; 
            background: url(../resource/menu2.png);
            overflow: hidden;
            transition: all 0.2s ease;
        }

        #tea_main_menu li.i1, li.i1 a {
            width: 150px; 
            height: 133px;
        }

        #tea_main_menu li.i2, li.i2 a  {
            width: 167px; 
            height: 133px;
        }

        #tea_main_menu li a.a1 {background-position: 0 0;}
        
        #tea_main_menu li a.a1:hover {background-position: 0 -133px;}

        #tea_main_menu li a.a2 {background-position: -150px 0;}

        #tea_main_menu li a.a2:hover {background-position: -150px -133px;}

        #tea_main_menu li a.a3 {background-position: -317px 0;}

        #tea_main_menu li a.a3:hover {background-position: -317px -133px;}

        #tea_main_menu li a.a4 {background-position: -484px 0;}

        #tea_main_menu li a.a4:hover {background-position: -484px -133px;}

        #tea_left_menu li a {
            display:block;
            background: url(../resource/menu4.png);
            overflow: hidden;
            transition: all 0.2s ease;
        }

        #tea_left_menu li.i1, #tea_left_menu li.i1 a {
            width: 133px;
            height: 133px;
        }

        #tea_left_menu li.i2, #tea_left_menu li.i2 a  {
            width: 133px;
            height: 133px;
        }

        #tea_left_menu li a.a1 {background-position: 0 0;}

        #tea_left_menu li a.a1:hover {background-position: -133px 0;}

        #tea_left_menu li a.a2 {background-position: 0 -133px;}

        #tea_left_menu li a.a2:hover {background-position: -133px -133px;}

        #tea_left_menu li a.a3 {background-position: 0 -266px;}

        #tea_left_menu li a.a3:hover {background-position: -133px -266px;}

        #tea_left_menu li a.a4 {background-position: 0 -399px;}

        #tea_left_menu li a.a4:hover {background-position: -133px -399px;}

        .TF_radio_box input { 
            display: none; 
        }

        .TF_radio_box label{
            display: inline-block;
            content: "";
            width: 15px;
            height: 15px;
/*          border-radius: 50%;*/
            border:2px solid #ef4949;
            background: #fff;
            cursor:pointer;
        }


        .TF_radio_box input:checked + label:after { 
            display: inline-block; 
            float: left;
            content:""; 
            width: 9px; 
            height: 9px; 
            position: relative;
            top: 3px;
            left: 3px;
            background: #ef4949; 
/*          border-radius: 50%;*/
        }

    </style>

</head>
<body>
</body>

<script type="text/javascript">

    var teach_answer = "月季花";

    var teach_choice = {
        "start_time": new Date(),
        "end_time": new Date(),
        "spend_time": 0,
        "product1": [
            [0, "../resource/teach/水仙.JPG", "草本植物", "", ""],
            [0, "../resource/teach/菊花.JPG", "草本植物", "", ""],
            [0, "../resource/teach/牡丹.JPG", "草本植物", "", ""],
            [0, "../resource/teach/紫罗兰.JPG", "草本植物", "", ""],
            [0, "../resource/teach/郁金香.JPG", "草本植物", "", ""],
        ],
        "product2": [
            [0, "../resource/teach/浮萍.JPG", "水生植物", "", ""],
            [0, "../resource/teach/碗莲.JPG", "水生植物", "", ""],
            [0, "../resource/teach/鸢尾.JPG", "水生植物", "", ""],
            [0, "../resource/teach/马蹄莲.JPG", "水生植物", "", ""],
            [0, "../resource/teach/水葫芦.JPG", "水生植物", "", ""],
        ],
        "product3": [
            [0, "../resource/teach/梅花.JPG", "木本植物", "", ""],
            [0, "../resource/teach/桂花.JPG", "木本植物", "", ""],
            [0, "../resource/teach/月季花.JPG", "木本植物", "", ""],
            [0, "../resource/teach/茉莉花.JPG", "木本植物", "", ""],
            [0, "../resource/teach/栀子花.JPG", "木本植物", "", ""],
        ],
        "product4": [],
        "product1_click":0,
        "product2_click":0,
        "product3_click":0,
        "product4_click":0,
    }


    function page_preview_after_init() {
        $("#next_phrase").unbind();
        $("#next_phrase").on("click", function () {
            config["change"] = 1;
        });
    }

    function page_teach_menu_after_init() {
        $("#teach_answer").html(teach_answer);

        $("#green_tea_main").unbind();
        $("#red_tea_main").unbind();
        $("#qing_tea_main").unbind();
        $("#hua_tea_main").unbind();

        $("#green_tea_main").on("click",function () {
            config["current"] = 1011 + config["base"];
            change_state(config);
        });

        $("#red_tea_main").on("click",function () {
            config["current"] = 1012 + config["base"];
            change_state(config);
        });

        $("#qing_tea_main").on("click",function () {
            config["current"] = 1013 + config["base"];
            change_state(config);
        });

        $("#hua_tea_main").on("click",function () {
            config["current"] = 1014 + config["base"];
            change_state(config);
        });
    }

    function teach_left_init() {
        $("#left_green_tea").unbind();
        $("#left_green_tea").on("click", function () {
            config["current"] = 1011 + config["base"];
            change_state(config);
        });
        $("#left_red_tea").unbind();
        $("#left_red_tea").on("click", function () {
            config["current"] = 1012 + config["base"];
            change_state(config);
        });
        $("#left_qing_tea").unbind();
        $("#left_qing_tea").on("click", function () {
            config["current"] = 1013 + config["base"];
            change_state(config);
        });

        $("#left_hua_tea").unbind();
        $("#left_hua_tea").on("click", function () {
            config["current"] = 1014 + config["base"];
            change_state(config);
        });
    }

    function teach_choice_init(current_choice) {
        $("#choice_1").unbind();
        $("#choice_1").on("click", function () {
            teach_choice_detail_display(current_choice[0]);
        });
        $("#choice_2").unbind();
        $("#choice_2").on("click", function () {
            teach_choice_detail_display(current_choice[1]);
        });
        $("#choice_3").unbind();
        $("#choice_3").on("click", function () {
            teach_choice_detail_display(current_choice[2]);
        });
        $("#choice_4").unbind();
        $("#choice_4").on("click", function () {
            teach_choice_detail_display(current_choice[3]);
        });
        $("#choice_5").unbind();
        $("#choice_5").on("click", function () {
            teach_choice_detail_display(current_choice[4]);
        });
    }

    function teach_choice_detail_display(current_choice_item) {
        $("#tea_name").html(get_product_name(current_choice_item));
        $("#tea_assortment").html(get_product_attribute(current_choice_item));
        $("#other_discription").html(get_product_other_description(current_choice_item));
        $("#select_pic").attr("src", get_product_file_path(current_choice_item));
        $("#tea_benefit").html(get_product_benefit(current_choice_item));
        $("#product_tips").css("display","none");
        $("#product_discription").css("display","block");
        $("#buy_button").css("visibility", "visiable");
        $("#buy_button").unbind();
        $("#buy_button").on("click", function () {
            var name = get_product_name(current_choice_item);
            if(name != teach_answer){
                alert("请找到" + teach_answer);
                return;
            }
            config["change"] = 1;
        })
    }

    function page_teach_product1_after_init() {
        // 设置页面详细信息
        set_page_detail(teach_choice["product1"]);
        // 四个标签按钮点击事件
        teach_left_init();
        // 五个商品点击事件
        teach_choice_init(teach_choice["product1"]);
    }

    function page_teach_product2_after_init() {
        // 设置页面详细信息
        set_page_detail(teach_choice["product2"]);
        // 四个标签按钮点击事件
        teach_left_init();
        // 五个商品点击事件
        teach_choice_init(teach_choice["product2"]);
    }

    function page_teach_product3_after_init() {
        // 设置页面详细信息
        set_page_detail(teach_choice["product3"]);
        // 四个标签按钮点击事件
        teach_left_init();
        // 五个商品点击事件
        teach_choice_init(teach_choice["product3"]);
    }

    function page_teach_product4_after_init() {
        // 设置页面详细信息
        set_page_detail(teach_choice["product4"]);
        // 四个标签按钮点击事件
        teach_left_init();
        // 五个商品点击事件
        teach_choice_init(teach_choice["product4"]);
    }

    function tea_task_after_init(){
        product_config = config_tea;
        product_question = question_tea;
        product_choose = choose_tea;
        product_choose["names"] =  random_choice_product(product_choose["names"], product_choose["names"].length);
        product_test = test_tea;
        for(var i = 0; i < product_test["tests"].length; ++i){
            product_test["tests"][i] = random_choice_product(product_test["tests"][i], product_test["tests"][i].length);
        }
        config["base"] += 1000;
        clear_choice();
    }

    function shampoo_task_after_init(){
        product_config = config_shampoo;
        product_question = question_shampoo;
        product_choose = choose_shampoo
        product_choose["names"] =  random_choice_product(product_choose["names"], product_choose["names"].length);
        product_test = test_shampoo;
        for(var i = 0; i < product_test["tests"].length; ++i){
            product_test["tests"][i] = random_choice_product(product_test["tests"][i], product_test["tests"][i].length);
        }
        config["base"] += 1000;
        clear_choice();
    }

    function brush_task_after_init(){
        product_config = config_brush;
        product_question = question_brush;
        product_choose = choose_brush;
        product_choose["names"] =  random_choice_product(product_choose["names"], product_choose["names"].length);
        product_test = test_brush;
        for(var i = 0; i < product_test["tests"].length; ++i){
            product_test["tests"][i] = random_choice_product(product_test["tests"][i], product_test["tests"][i].length);
        }
        config["base"] += 1000;
        clear_choice();
    }


    // choose menu
    function page_choose_menu_after_init() {
        var current = product_choose["current"];
        var answer = product_choose["names"][current];
        $("#choose_task_number").html(current + 1);
        $("#answer").html(answer);

        $("#green_tea_main").unbind();
        $("#red_tea_main").unbind();
        $("#qing_tea_main").unbind();
        $("#hua_tea_main").unbind();

        $("#green_tea_main").on("click",function () {
            config["current"] = 1031 + config["base"];
            change_state(config);
        });

        $("#red_tea_main").on("click",function () {
            config["current"] = 1032 + config["base"];
            change_state(config);
        });

        $("#qing_tea_main").on("click",function () {
            config["current"] = 1033 + config["base"];
            change_state(config);
        });

        $("#hua_tea_main").on("click",function () {
            config["current"] = 1034 + config["base"];
            change_state(config);
        });
    }

    function choose_left_init() {
        $("#left_green_tea").unbind();
        $("#left_green_tea").on("click", function () {
            config["current"] = 1031 + config["base"];
            change_state(config);
        });
        $("#left_red_tea").unbind();
        $("#left_red_tea").on("click", function () {
            config["current"] = 1032 + config["base"];
            change_state(config);
        });
        $("#left_qing_tea").unbind();
        $("#left_qing_tea").on("click", function () {
            config["current"] = 1033 + config["base"];
            change_state(config);
        });

        $("#left_hua_tea").unbind();
        $("#left_hua_tea").on("click", function () {
            config["current"] = 1034 + config["base"];
            change_state(config);
        });
    }

    function choose_choice_init(current_choice) {
        $("#choice_1").unbind();
        $("#choice_1").on("click", function () {
            choose_choice_detail_display(current_choice[0]);
        });
        $("#choice_2").unbind();
        $("#choice_2").on("click", function () {
            choose_choice_detail_display(current_choice[1]);
        });
        $("#choice_3").unbind();
        $("#choice_3").on("click", function () {
            choose_choice_detail_display(current_choice[2]);
        });
        $("#choice_4").unbind();
        $("#choice_4").on("click", function () {
            choose_choice_detail_display(current_choice[3]);
        });
        $("#choice_5").unbind();
        $("#choice_5").on("click", function () {
            choose_choice_detail_display(current_choice[4]);
        });
    }

    function choose_choice_detail_display(current_choice_item) {
        $("#tea_name").html(get_product_name(current_choice_item));
        $("#tea_assortment").html(get_product_attribute(current_choice_item));
        $("#other_discription").html(get_product_other_description(current_choice_item));
        $("#select_pic").attr("src", get_product_file_path(current_choice_item));
        $("#tea_benefit").html(get_product_benefit(current_choice_item));
        $("#product_tips").css("display","none");
        $("#product_discription").css("display","block");
        $("#buy_button").css("visibility", "visiable");
        $("#buy_button").unbind();
        $("#buy_button").on("click", function () {
            var name = get_product_name(current_choice_item);
            var current = product_choose["current"];
            var answer = product_choose["names"][current];
            if(name != answer){
                alert("请找到" + answer);
                return;
            }
            product_choose["current"] += 1;
            if (product_choose["current"] < product_choose["names"].length){
                config["current"] = 1030 + config["base"];
                change_state(config);
                return;
            }
            config["change"] = 1;
        })
    }
    
    function choose_set_page_detail(choice) {
        set_page_detail(choice);
        var current = product_choose["current"];
        var answer = product_choose["names"][current];
        $("#answer").html(answer);
    }

    function page_choose_product1_after_init() {
        // 设置页面详细信息
        choose_set_page_detail(choice["product1"]);
        // 四个标签按钮点击事件
        choose_left_init();
        // 五个商品点击事件
        choose_choice_init(choice["product1"]);
    }

    function page_choose_product2_after_init() {
        // 设置页面详细信息
        choose_set_page_detail(choice["product2"]);
        // 四个标签按钮点击事件
        choose_left_init();
        // 五个商品点击事件
        choose_choice_init(choice["product2"]);
    }

    function page_choose_product3_after_init() {
        // 设置页面详细信息
        choose_set_page_detail(choice["product3"]);
        // 四个标签按钮点击事件
        choose_left_init();
        // 五个商品点击事件
        choose_choice_init(choice["product3"]);
    }

    function page_choose_product4_after_init() {
        // 设置页面详细信息
        choose_set_page_detail(choice["product4"]);
        // 四个标签按钮点击事件
        choose_left_init();
        // 五个商品点击事件
        choose_choice_init(choice["product4"]);
    }


    var page_tea_item = {
        3: {"next":10, "html":page_tea_task, "wait":0, "auto":0, "before_init":null, "after_init":tea_task_after_init},
        10: {"next":10, "html":page_tea_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_product_menu_after_init},
        11: {"next":20, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product1_after_init},
        12: {"next":20, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product2_after_init},
        13: {"next":20, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product3_after_init},
        14: {"next":20, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product4_after_init},
        20: {"next":30, "html":page_choose_preview, "wait":10000, "auto":0, "before_init":null, "after_init":page_preview_after_init},
        30: {"next":30, "html":page_tea_choose_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_menu_after_init},
        31: {"next":40, "html":page_tea_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product1_after_init},
        32: {"next":40, "html":page_tea_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product2_after_init},
        33: {"next":40, "html":page_tea_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product3_after_init},
        34: {"next":40, "html":page_tea_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product4_after_init},
        40: {"next":50, "html":page_question, "wait":10000, "auto":0, "before_init":null, "after_init":page_question_after_init},
        50: {"next":60, "html":page_test, "wait":10000, "auto":0, "before_init":null, "after_init":page_test_after_init},
        60: {"next":60, "html":page_phrase_transition, "wait":10000, "auto":0, "before_init":null, "after_init":page_phrase_transition_after_init},
    };

    var page_shampoo_item = {
        3: {"next":10, "html":page_shampoo_task, "wait":0, "auto":0, "before_init":null, "after_init":shampoo_task_after_init},
        10: {"next":10, "html":page_shampoo_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_product_menu_after_init},
        11: {"next":20, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product1_after_init},
        12: {"next":20, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product2_after_init},
        13: {"next":20, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product3_after_init},
        14: {"next":20, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product4_after_init},
        20: {"next":30, "html":page_choose_preview, "wait":10000, "auto":0, "before_init":null, "after_init":page_preview_after_init},
        30: {"next":30, "html":page_shampoo_choose_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_menu_after_init},
        31: {"next":40, "html":page_shampoo_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product1_after_init},
        32: {"next":40, "html":page_shampoo_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product2_after_init},
        33: {"next":40, "html":page_shampoo_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product3_after_init},
        34: {"next":40, "html":page_shampoo_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product4_after_init},
        40: {"next":50, "html":page_question, "wait":10000, "auto":0, "before_init":null, "after_init":page_question_after_init},
        50: {"next":60, "html":page_test, "wait":10000, "auto":0, "before_init":null, "after_init":page_test_after_init},
        60: {"next":60, "html":page_phrase_transition, "wait":10000, "auto":0, "before_init":null, "after_init":page_phrase_transition_after_init},
    };

    var page_brush_item = {
        3: {"next":10, "html":page_brush_task, "wait":0, "auto":0, "before_init":null, "after_init":brush_task_after_init},
        10: {"next":10, "html":page_brush_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_product_menu_after_init},
        11: {"next":20, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product1_after_init},
        12: {"next":20, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product2_after_init},
        13: {"next":20, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product3_after_init},
        14: {"next":20, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product4_after_init},
        20: {"next":30, "html":page_choose_preview, "wait":10000, "auto":0, "before_init":null, "after_init":page_preview_after_init},
        30: {"next":30, "html":page_brush_choose_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_menu_after_init},
        31: {"next":40, "html":page_brush_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product1_after_init},
        32: {"next":40, "html":page_brush_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product2_after_init},
        33: {"next":40, "html":page_brush_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product3_after_init},
        34: {"next":40, "html":page_brush_choose_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_choose_product4_after_init},
        40: {"next":50, "html":page_question, "wait":10000, "auto":0, "before_init":null, "after_init":page_question_after_init},
        50: {"next":60, "html":page_test, "wait":10000, "auto":0, "before_init":null, "after_init":page_test_after_init},
        60: {"next":60, "html":page_phrase_transition, "wait":10000, "auto":0, "before_init":null, "after_init":page_phrase_transition_after_init},
    };

    function generate_pages(first, second, third){
        var pages = {
            1: {"next":3, "html":page_introduction, "wait":0, "auto":0, "before_init":null, "after_init":null},
            3: {"next":10, "html":page_teach_preview, "wait":10, "auto":0, "before_init":null, "after_init":page_preview_after_init},
            10: {"next":10, "html":page_teach_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_teach_menu_after_init},
            11: {"next":40, "html":page_teach_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_teach_product1_after_init},
            12: {"next":40, "html":page_teach_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_teach_product2_after_init},
            13: {"next":40, "html":page_teach_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_teach_product3_after_init},
            40: {"next":40, "html":page_teach_transition, "wait":1, "auto":0, "before_init":null, "after_init":page_phrase_transition_after_init},
        };
        var max_index = 0;
        var base = 1000;
        for(var item in first){
            item = parseInt(item)
            pages[item + base] = first[item];
            pages[item + base]["next"] += base;
            max_index = Math.max(max_index, item + base);
        }
        console.log(pages)
        base = 2000;
        for(var item in second){
            item = parseInt(item)
            pages[item + base] = second[item];
            pages[item + base]["next"] += base;
            max_index = Math.max(max_index, item + base);
        }
        console.log(pages)
        var base = 3000;
        for(var item in third){
            item = parseInt(item)
            pages[item + base] = third[item];
            pages[item + base]["next"] += base;
            max_index = Math.max(max_index, item + base);
        }
        console.log(pages)
        // 找到最后一项, 最大一项

        pages[max_index]["html"] = page_final_submit;
        pages[max_index]["after_init"] = page_final_submit_after_init;
        console.log("max index:", max_index);
        console.log(pages)
        return pages;
    }

    var config = {
        "base": -1000,
        "current":1,
        "pages": {
            1001: {"next":1002, "html":page_introduction, "wait":0, "auto":0, "before_init":null, "after_init":null},
            
            1002: {"next":1003, "html":page_tea_introduction, "wait":2, "auto":0, "before_init":null, "after_init":null},
            1003: {"next":1004, "html":page_tea_task, "wait":2, "auto":0, "before_init":null, "after_init":tea_task_after_init},
            1004: {"next":1004, "html":page_tea_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_product_menu_after_init},
            1005: {"next":1005, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product1_after_init},
            1006: {"next":1006, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product2_after_init},
            1007: {"next":1007, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product3_after_init},
            1008: {"next":1008, "html":page_tea_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product4_after_init},
            1009: {"next":1009, "html":page_question, "wait":0, "auto":0, "before_init":null, "after_init":page_question_after_init},
            1010: {"next":1010, "html":page_phrase_transition, "wait":0, "auto":0, "before_init":null, "after_init":page_phrase_transition_after_init},

            2002: {"next":2003, "html":page_shampoo_introduction, "wait":0, "auto":0, "before_init":null, "after_init":null},
            2003: {"next":2004, "html":page_shampoo_task, "wait":0, "auto":0, "before_init":null, "after_init":shampoo_task_after_init},
            2004: {"next":2004, "html":page_shampoo_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_product_menu_after_init},
            2005: {"next":2005, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product1_after_init},
            2006: {"next":2006, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product2_after_init},
            2007: {"next":2007, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product3_after_init},
            2008: {"next":2008, "html":page_shampoo_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product4_after_init},
            2009: {"next":2009, "html":page_question, "wait":0, "auto":0, "before_init":null, "after_init":page_question_after_init},
            2010: {"next":2010, "html":page_phrase_transition, "wait":0, "auto":0, "before_init":null, "after_init":page_phrase_transition_after_init},

            3002: {"next":3003, "html":page_brush_introduction, "wait":0, "auto":0, "before_init":null, "after_init":null},
            3003: {"next":3004, "html":page_brush_task, "wait":0, "auto":0, "before_init":null, "after_init":brush_task_after_init},
            3004: {"next":3004, "html":page_brush_menu, "wait":10000, "auto":0, "before_init":null, "after_init":page_product_menu_after_init},
            3005: {"next":3005, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product1_after_init},
            3006: {"next":3006, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product2_after_init},
            3007: {"next":3007, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product3_after_init},
            3008: {"next":3008, "html":page_brush_product, "wait":10000, "auto":0, "before_init":null, "after_init":page_product4_after_init},
            3009: {"next":3009, "html":page_question, "wait":0, "auto":0, "before_init":null, "after_init":page_question_after_init},
            3010: {"next":3010, "html":page_final_submit, "wait":0, "auto":0, "before_init":null, "after_init":page_final_submit_after_init},

        }
    };


    function reset_config(number) {
        console.log("number:", number)
        if(number == 1){
            config["pages"] = generate_pages(page_tea_item, page_shampoo_item, page_brush_item);
            order_number = 1;
            order_sign = "tea_shampoo_brush";
            console.log("page_tea_item, page_shampoo_item, page_brush_item", order_number, order_sign)
        }else if (number == 2){
            config["pages"] = generate_pages(page_tea_item, page_brush_item, page_shampoo_item);
            order_number = 2;
            order_sign = "tea_brush_shampoo";
            console.log("page_tea_item, page_brush_item, page_shampoo_item", order_number, order_sign)
        }else if (number == 3){
            config["pages"] = generate_pages(page_shampoo_item, page_tea_item, page_brush_item);
            order_number = 3;
            order_sign = "shampoo_tea_brush";
            console.log("page_shampoo_item, page_tea_item, page_brush_item", order_number, order_sign)
        }else if (number == 4){
            config["pages"] = generate_pages(page_shampoo_item, page_brush_item, page_tea_item);
            order_number = 4;
            order_sign = "shampoo_brush_tea";
            console.log("page_shampoo_item, page_brush_item, page_tea_item", order_number, order_sign)
        }else if (number == 5){
            config["pages"] = generate_pages(page_brush_item, page_tea_item, page_shampoo_item);
            order_number = 5;
            order_sign = "brush_tea_shampoo";
            console.log("page_brush_item, page_tea_item, page_shampoo_item", order_number, order_sign)
        }else if (number == 6){
            config["pages"] = generate_pages(page_brush_item, page_shampoo_item, page_tea_item);
            order_number = 6;
            order_sign = "brush_shampoo_tea";
            console.log("page_brush_item, page_shampoo_item, page_tea_item", order_number, order_sign)
        }else{
            config["pages"] = generate_pages(page_tea_item, page_shampoo_item, page_brush_item);
            order_number = 1;
            order_sign = "tea_shampoo_brush";
            console.log("page_tea_item, page_shampoo_item, page_brush_item", order_number, order_sign)
        }
    }


    // 对Date的扩展，将 Date 转化为指定格式的String
    // 月(M)、日(d)、小时(h)、分(m)、秒(s)、季度(q) 可以用 1-2 个占位符，
    // 年(y)可以用 1-4 个占位符，毫秒(S)只能用 1 个占位符(是 1-3 位的数字)
    // 例子：
    // (new Date()).Format("yyyy-MM-dd hh:mm:ss.S") ==> 2006-07-02 08:09:04.423
    // (new Date()).Format("yyyy-M-d h:m:s.S")      ==> 2006-7-2 8:9:4.18
    Date.prototype.format = function(fmt)
    { //author: meizz
        var o = {
            "M+" : this.getMonth()+1,                 //月份
            "d+" : this.getDate(),                    //日
            "h+" : this.getHours(),                   //小时
            "m+" : this.getMinutes(),                 //分
            "s+" : this.getSeconds(),                 //秒
            "q+" : Math.floor((this.getMonth()+3)/3), //季度
            "S"  : this.getMilliseconds()             //毫秒
        };
        if(/(y+)/.test(fmt))
            fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));
        for(var k in o)
            if(new RegExp("("+ k +")").test(fmt))
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
        return fmt;
    }

    function set_body(html){
        $("body").html(html)
    }

    function saveFile(filename, file_content) {
        var file = new File([file_content], filename, { type:"text/plain;charset=utf-8" });
        saveAs(file);
    }

    function print_config(states) {
        console.log("current: ", states["current"]);
        for(var item in states["pages"]){
            var value = states["pages"][item]
            console.log("page:", item, "next", value["next"], "wait:", value["wait"], "auto:", value["auto"]);
            console.log(value["html"]);
            console.log("");
            console.log("");
        }
    }

    function change_state(states){
        var current = states["current"];
        var current_page = states["pages"][current];
        states["next"] = current_page["next"];
        states["html"] = current_page["html"];
        states["wait"] = current_page["wait"];
        states["auto"] = current_page["auto"];
        states["before_init"] = current_page["before_init"];
        states["after_init"] = current_page["after_init"];
        states["start"] = Date.parse(new Date());
        states["change"] = 0;
        if(states["before_init"]){
            states["before_init"]();
        }
        set_body(states["html"]);
        if(states["after_init"]){
            states["after_init"]();
        }
    };

    function working_machine(states) {
        if(states["change"] && (states["current"] != states["next"])){
            states["current"] = states["next"];
            change_state(states);
        }
    };

    function check_and_show_next(states){
        var time_spend = (Date.parse(new Date()) - states["start"]) / 1000;
        if(time_spend >= states["wait"]){
            if(states["auto"]){
                states["change"] = 1;
            }else{
                $("#next_tips").css("visibility","visible");
                $("#next_tips").unbind();
                $("#next_tips").on("click",function(){
                    console.log("press next_tips")
                    states["change"] = 1;
                });
            }
        }
    };

    function register_key_event(states) {
        // 设置父窗口事件
        document.onkeydown = function (event) {
            var e = event || window.event || arguments.callee.caller.arguments[0];
            console.log("press key code: ", e.keyCode);
            if(e && (e.keyCode == 13 || e.keyCode == 32 ||  e.keyCode == 78 || e.keyCode == 88)){
                // keyCode: 13 Enter, keyCode: 32 Space, keyCode: 78 n N, keyCode:88 x X
                if(states["auto"] == 0){
                    var time_spend = (Date.parse(new Date()) - states["start"]) / 1000;   // 时间s
                    if(time_spend >= states["wait"]){
                        states["change"] = 1;
                    }else{
                        console.log("current:", states["current"], "spend:", time_spend, "wait:", states["wait"]);
                    }
                    $("#next_page").trigger('click');
                }else{
                    console.log("current page auto:", states["current"]);
                }
            }
        };
    };

    // page_product_menu 初始化绑定事件
    function page_product_menu_after_init(){
        $("#green_tea_main").unbind();
        $("#red_tea_main").unbind();
        $("#qing_tea_main").unbind();
        $("#hua_tea_main").unbind();

        $("#green_tea_main").on("click",product1_onclick);
        $("#red_tea_main").on("click",product2_onclick);
        $("#qing_tea_main").on("click",product3_onclick);
        $("#hua_tea_main").on("click",product4_onclick);

        choice["product1"] = random_choice_product(product_config["product1"], 5);
        choice["product2"] = random_choice_product(product_config["product2"], 5);
        choice["product3"] = random_choice_product(product_config["product3"], 5);
        choice["product4"] = random_choice_product(product_config["product4"], 5);

        console.log("product1:");
        for (var i = 0; i <choice["product1"].length; i++){
            console.log(choice["product1"][i]);
        }
        console.log("product2:");
        for (var i = 0; i <choice["product2"].length; i++){
            console.log(choice["product2"][i]);
        }
        console.log("product3:");
        for (var i = 0; i <choice["product3"].length; i++){
            console.log(choice["product3"][i]);
        }
        console.log("product4:");
        for (var i = 0; i <choice["product4"].length; i++){
            console.log(choice["product4"][i]);
        }
    }

    function product1_onclick(){
        config["current"] = 1011 + config["base"];
        change_state(config);
        choice["product1_click"] = 1;
        choice["start_time"] = new Date();
        console.log("product1_onclick:", choice["start_time"])
    }
    function product2_onclick(){
        config["current"] = 1012 + config["base"];
        change_state(config);
        choice["product2click"] = 1;
        choice["start_time"] = new Date();
        console.log("product2_onclick:", choice["start_time"])
    }
    function product3_onclick(){
        config["current"] = 1013 + config["base"];
        change_state(config);
        choice["product3_click"] = 1;
        choice["start_time"] = new Date();
        console.log("product3_onclick:", choice["start_time"])
    }
    function product4_onclick(){
        config["current"] = 1014 + config["base"];
        change_state(config);
        choice["product4_click"] = 1;
        choice["start_time"] = new Date();
        console.log("product4_onclick:", choice["start_time"])
    }

    //page3_1 初始化

    var choice = {
        "start_time": new Date(),
        "end_time": new Date(),
        "spend_time": 0,
        "product1": [],
        "product2": [],
        "product3": [],
        "product4": [],
        "product1_click":0,
        "product2_click":0,
        "product3_click":0,
        "product4_click":0,
        "tostring": function () {
            var str = this["start_time"].format("yyyy-MM-dd_hh:mm:ss") + " "
                    + this["end_time"].format("yyyy-MM-dd_hh:mm:ss") + " "
                    + Math.round(this["spend_time"] / 1000) + " "
            for(var i=0; i < this["product1"].length; i++) {
                var pathname = this["product1"][i][1];
                var index1 = pathname.lastIndexOf("/");
                var index2 = pathname.lastIndexOf(".");
                str = str + pathname.substring(index1+1,index2) + " " + this["product1"][i][0] + " ";
            }
            for(var i=0; i < this["product2"].length; i++) {
                var pathname = this["product2"][i][1];
                var index1 = pathname.lastIndexOf("/");
                var index2 = pathname.lastIndexOf(".");
                str = str + pathname.substring(index1+1,index2) + " " + this["product2"][i][0] + " ";
            }
            for(var i=0; i < this["product3"].length; i++) {
                var pathname = this["product3"][i][1];
                var index1 = pathname.lastIndexOf("/");
                var index2 = pathname.lastIndexOf(".");
                str = str + pathname.substring(index1+1,index2) + " " + this["product3"][i][0] + " ";
            }
            for(var i=0; i < this["product4"].length; i++) {
                var pathname = this["product4"][i][1];
                var index1 = pathname.lastIndexOf("/");
                var index2 = pathname.lastIndexOf(".");
                str = str + pathname.substring(index1+1,index2) + " " + this["product4"][i][0] + " ";
            }
            return str;
        }
    }

    var choice_strings = [];

    function left_init() {
        $("#left_green_tea").unbind();
        $("#left_green_tea").on("click", function () {
            choice["product1_click"] = 1;
            config["current"] = 1011 + config["base"];
            change_state(config);
        });
        $("#left_red_tea").unbind();
        $("#left_red_tea").on("click", function () {
            choice["product2_click"] = 1;
            config["current"] = 1012 + config["base"];
            change_state(config);
        });
        $("#left_qing_tea").unbind();
        $("#left_qing_tea").on("click", function () {
            choice["product3_click"] = 1;
            config["current"] = 1013 + config["base"];
            change_state(config);
        });
        $("#left_hua_tea").unbind();
        $("#left_hua_tea").on("click", function () {
            choice["product4_click"] = 1;
            config["current"] = 1014 + config["base"];
            change_state(config);
        });
    }
    function check_show_buy_button(current_choice_item){
        var show = false;
        var show_count = 0;
        for(var i=0;i<choice["product1"].length; i++){
            if(choice["product1"][i][0]){
                show_count++;
            }
        }
        for(var i=0;i<choice["product2"].length; i++){
            if(choice["product2"][i][0]){
                show_count++;
            }
        }
        for(var i=0;i<choice["product3"].length; i++){
            if(choice["product3"][i][0]){
                show_count++;
            }
        }
        for(var i=0;i<choice["product4"].length; i++){
            if(choice["product4"][i][0]){
                show_count++;
            }
        }

        var type_count = choice["product1_click"] + choice["product2_click"]+ choice["product3_click"]+choice["product4_click"];

        if(show_count>=5 || type_count>=4) {
            $("#buy_button").css("visibility","visible");
            $("#buy_button").unbind();
            $("#buy_button").on("click",function(){
                save_on_click(current_choice_item[1]);
            });
        }else{
            $("#buy_button").css("visibility","hidden");
            $("#buy_button").unbind();
            $("#buy_button").on("click",function(){});
        }


    }

    function choice_init(current_choice) {
        $("#choice_1").unbind();
        $("#choice_1").on("click", function () {
            choice_detail_display(current_choice[0]);
        });
        $("#choice_2").unbind();
        $("#choice_2").on("click", function () {
            choice_detail_display(current_choice[1]);
        });
        $("#choice_3").unbind();
        $("#choice_3").on("click", function () {
            choice_detail_display(current_choice[2]);
        });
        $("#choice_4").unbind();
        $("#choice_4").on("click", function () {
            choice_detail_display(current_choice[3]);
        });
        $("#choice_5").unbind();
        $("#choice_5").on("click", function () {
            choice_detail_display(current_choice[4]);
        });
    }
    
    function choice_detail_display(current_choice_item) {
        $("#tea_name").html(get_product_name(current_choice_item));
        $("#tea_assortment").html(get_product_attribute(current_choice_item));
        $("#other_discription").html(get_product_other_description(current_choice_item));
        $("#select_pic").attr("src", get_product_file_path(current_choice_item));
        $("#tea_benefit").html(get_product_benefit(current_choice_item));
        set_product_chosen(current_choice_item);
        check_show_buy_button(current_choice_item);
        $("#product_tips").css("display","none");
        $("#product_discription").css("display","block");
    }

    function page_product1_after_init(){
        // 设置页面详细信息
        set_page_detail(choice["product1"]);
        // 四个标签按钮点击事件
        left_init();
        // 五个商品点击事件
        choice_init(choice["product1"]);
    }

    function page_product2_after_init(){
        // 设置页面详细信息
        set_page_detail(choice["product2"]);
        // 四个标签按钮点击事件
        left_init();
        // 五个商品点击事件
        choice_init(choice["product2"]);
    }

    function page_product3_after_init(){
        // 设置页面详细信息
        set_page_detail(choice["product3"]);
        // 四个标签按钮点击事件
        left_init();
        // 五个商品点击事件
        choice_init(choice["product3"]);
    }

    function page_product4_after_init(){
        // 设置页面详细信息
        set_page_detail(choice["product4"]);
        // 四个标签按钮点击事件
        left_init();
        // 五个商品点击事件
        choice_init(choice["product4"]);
    }

    function get_filename(filepath) {
        var index1 = filepath.lastIndexOf("/");
        var index2 = filepath.lastIndexOf(".");
        return filepath.substring(index1+1,index2);
    }

    function get_product_name(choice_item) {
        return get_filename(get_product_file_path(choice_item));
    }

    function set_product_chosen(choice_item) {
        choice_item[0] = 1;
    }
    
    function get_product_file_path(choice_item) {
        return choice_item[1];
    }

    function get_product_attribute(choice_item) {
        return choice_item[2];
    }

    function get_product_benefit(choice_item) {
        return choice_item[3];
    }

    function get_product_other_description(choice_item) {
        return choice_item[4];
    }

    function get_product_benefit_description(choice_item) {
        return choice_item[5];
    }

    function set_page_detail(choice) {
        // 设置标题
        var attribute = get_product_attribute(choice[0]);
        $("#assortment_title").html(attribute);
        if(title_color_map[attribute] != null){
            $("#assortment_title").css("background-color", title_color_map[attribute]);
        }

        // 设置名称
        $("#text_1").html(get_product_name(choice[0]));
        $("#text_2").html(get_product_name(choice[1]));
        $("#text_3").html(get_product_name(choice[2]));
        $("#text_4").html(get_product_name(choice[3]));
        $("#text_5").html(get_product_name(choice[4]));
        // 设置图片
        $("#pic_1").attr("src", get_product_file_path(choice[0]));
        $("#pic_2").attr("src", get_product_file_path(choice[1]));
        $("#pic_3").attr("src", get_product_file_path(choice[2]));
        $("#pic_4").attr("src", get_product_file_path(choice[3]));
        $("#pic_5").attr("src", get_product_file_path(choice[4]));
    }

    function random_choice_product(product_arr, num) {
        var product_index = Array.from(Array(product_arr.length).keys())
        shuffle(product_index);
        var product_chosen = [];
        for(var i=0; i<num; i++){
            product_chosen.push(product_arr[product_index[i]]);
        }
        return product_chosen;
    }

    function shuffle(a) {
        var len = a.length;
        for (var i = 0; i < len - 1; i++) {
            var index = parseInt(Math.random() * (len - i));
            var temp = a[index];
            a[index] = a[len - i - 1];
            a[len - i - 1] = temp;
        }
    }

    function save_on_click(final_choose) {
        console.log("save_in_click", final_choose);
        choice["end_time"] = new Date();
        choice["spend_time"] = choice["end_time"] - choice["start_time"];
        var string = product_config["name"] + " "
            + get_filename(final_choose) + " "
            + choice.tostring();
        console.log(string);
        choice_strings.push(string);

        config["change"] = 1;

        console.log("choice_strings:")
        for(var i = 0; i < choice_strings.length; ++i){
            console.log(i+1, ":", choice_strings[i])
        }

    }

    
    // page question
    var questions = {
        "current":0,
        "answers":[]
    }
    var question_answers = [];
    function show_current_question() {
        var index = questions["current"];
        if(index >= product_question["questions"].length){
            console.log("question end, index: ", index);
            var question_answer = {};
            question_answer[product_config["name"]] = questions["answers"];
            question_answers.push(question_answer);
            config["change"] = 1;
            return;
        }
        var question = product_question["questions"][index];
        set_body(question["template"]);
        if(question.hasOwnProperty("content") && question["content"]!=""){
            $("#content").html(question["content"]);
        }
        if(question.hasOwnProperty("left") && question["left"]!=""){
            $("#left").html(question["left"]);
        }
        if(question.hasOwnProperty("right") && question["right"]!=""){
            $("#right").html(question["right"]);
        }
        $("#next_page").unbind();
        $("#next_page").on("click",function () {
            var val=$('input:radio[name="one_choice"]:checked').val();
            if(val==null){
                console.log("question select nothing", question)
                alert("请选择一个选项");
                return;
            }
            var val_int = parseInt(val);
            questions["answers"].push({"id": question["id"], "answer": val_int});
            questions["current"] = index + 1;
            show_current_question();
        });
    }
    
    function page_question_after_init() {
        // 此时要页面
        $("#next_tips").unbind();
        $("#next_tips").on("click", function () {
            questions["current"] = 0;
            show_current_question();
        })

        // 此时不要页面
//        questions["current"] = 0;
//        show_current_question();
    }

    // page_test1
    var tests = {
        "start":0,
        "group":0,
        "current":0,
        "answers":[]
    }
    var test_answers = [];
    function show_current_test() {

        while(tests["current"] >= product_test["tests"][tests["group"]].length){
            tests["group"] += 1;
            tests["current"] = 0;
            if(tests["group"] >= product_test["tests"].length){
                console.log("test end, index: ", tests["group"]);
                var test_answer = {};
                test_answer[product_config["name"]] = tests["answers"];
                test_answers.push(test_answer);
                config["change"] = 1;
                return;
            }
        }
        var index = tests["current"];
        var group = tests["group"];
        var test = product_test["tests"][group][index];

        set_body(test["template"]);
        if(test.hasOwnProperty("content") && test["content"]!=""){
            $("#content").html(test["content"]);
        }
        if(test.hasOwnProperty("left") && test["left"]!=""){
            $("#left").html(test["left"]);
        }
        if(test.hasOwnProperty("right") && test["right"]!=""){
            $("#right").html(test["right"]);
        }

        for(var i = 0; i < test["pictures"].length; i++){
            var pic = i + 1;
            var pic_str = pic + "";

            var name_id = "#TF_name" + pic_str;
            var picture_id = "#TF_pic" + pic_str;
            var attribute_id = "#TF_attribute" + pic_str;
            var benefit_id = "#TF_benefit" + pic_str;
            $(name_id).html(test["pictures"][i]["name"]);
            $(picture_id).attr("src", test["pictures"][i]["src"]);
            $(attribute_id).html(test["pictures"][i]["attribute"]);
            $(benefit_id).html(test["pictures"][i]["benefit"]);
        }


        if(!test.hasOwnProperty("true") || test["true"]==""){
            alert("这个问题没有正确答案！！！");
            $("#next_page").unbind();
            return;
        }

        $("#next_page").unbind();
        $("#next_page").on("click",function () {
            var val=$('input:radio[name="one_choice"]:checked').val();
            if(val==null){
                console.log("test select nothing", test)
                //alert("请选择一个选项");
                return;
            }
            var correct = (val == test["true"]) ? 1 : 0;
            var spend = new Date() - tests["start"];
            tests["answers"].push({"id": test["id"], "answer": correct, "RT":spend});
            tests["current"] = index + 1;
            tests["start"] = new Date();
            show_current_test();
        });

        $("#choice_1").unbind();
        $("#choice_2").unbind();
        $("#choice_1").on("click", function () {
            $("#next_page").trigger('click');
        });
        $("#choice_2").on("click", function () {
            $("#next_page").trigger('click');
        });

        tests["start"] = new Date();
    }


    function page_test_after_init() {
        $("#next_tips").unbind();
        $("#next_tips").on("click", function () {
            tests["start"] = new Date();
            tests["group"] = 0;
            tests["current"] = 0;
            show_current_test();
        })
    }



    // page phrase transition
    function page_phrase_transition_after_init() {
        $("#next_phrase").unbind();
        $("#next_phrase").on("click", function () {
            config["current"] = 1003 + config["base"] + 1000;
            change_state(config);
        });
    }

    // page final submit
    function page_final_submit_after_init() {
        $("#next_phrase").unbind();
        $("#next_phrase").on("click", function () {
            var _username = $("input[name='username']").val();
            if(_username == null || _username == ""){
                alert("请输入姓名");
                return;
            }

            var _gender= $('input:radio[name="gender"]:checked').val();
            if(_gender == null || _gender == ""){
                alert("请选择性别");
                return;
            }

            var _age = $("input[name='age']").val();
            if(_age == null || _age == ""){
                alert("请输入年龄");
                return;
            }

            var _major = $("input[name='major']").val();
            if(_major == null || _major == ""){
                alert("请输入专业");
                return;
            }

            var _grade = $("select[name='grade'] option:selected").val();
            if(_grade == null || _grade == ""){
                alert("请选择专业");
                return;
            }

            var _phone = $("input[name='phone']").val();
            if(_phone == null || _phone == ""){
                alert("请输入手机号");
                return;
            }

            var _purpose = $("input[name='purpose']").val();

            console.log("username:", _username);
            console.log("gender:", _gender);
            console.log("age:", _age);
            console.log("major:", _major);
            console.log("grade:", _grade);
            console.log("phone:", _phone);
            console.log("purpose:", _purpose);

            if(_username != null && _username != "" ){
                username = _username;
            }

            if(_gender != null && _gender != "" ){
                gender = _gender;
            }

            if(_age != null && _age != "" ){
                age = _age;
            }

            if(_major != null && _major != "" ){
                major = _major;
            }

            if(_grade != null && _grade != "" ){
                grade = _grade;
            }

            if(_phone != null && _phone != "" ){
                phone = _phone;
            }

            if(_purpose != null && _purpose != "" ){
                purpose = _purpose;
            }

            // 保存文件
            save_final_file();
        });
    }
    
    function save_final_file() {
        var filename = condition + "_"
                    + order_number + "_"
                    + choice["end_time"].format("yyyy_MM_dd_hh_mm") + "_"
                    + username + ".txt";

        var stringObj = {
            "username": username,
            "gender": gender,
            "age": age,
            "major": major,
            "grade": grade,
            "phone": phone,
            "condition": condition,
            "order_number": order_number,
            "order_sign": order_sign,
            "purpose": purpose,
            "choice": choice_strings.sort(),
            "questions": question_answers,
            "tests": test_answers,
        };
        var string = JSON.stringify(stringObj,null,"\t")
        console.log("final save:", string)
        saveFile(filename, string);
    }
    
    function clear_choice() {
        choice = {
            "start_time": new Date(),
            "end_time": new Date(),
            "spend_time": 0,
            "product1": [],
            "product2": [],
            "product3": [],
            "product4": [],
            "product1_click":0,
            "product2_click":0,
            "product3_click":0,
            "product4_click":0,
            "tostring": function () {
                var str = this["start_time"].format("yyyy-MM-dd_hh:mm:ss") + " "
                    + this["end_time"].format("yyyy-MM-dd_hh:mm:ss") + " "
                    + Math.round(this["spend_time"] / 1000) + " "
                for(var i=0; i < this["product1"].length; i++) {
                    var pathname = this["product1"][i][1];
                    var index1 = pathname.lastIndexOf("/");
                    var index2 = pathname.lastIndexOf(".");
                    str = str + pathname.substring(index1+1,index2) + " " + this["product1"][i][0] + " ";
                }
                for(var i=0; i < this["product2"].length; i++) {
                    var pathname = this["product2"][i][1];
                    var index1 = pathname.lastIndexOf("/");
                    var index2 = pathname.lastIndexOf(".");
                    str = str + pathname.substring(index1+1,index2) + " " + this["product2"][i][0] + " ";
                }
                for(var i=0; i < this["product3"].length; i++) {
                    var pathname = this["product3"][i][1];
                    var index1 = pathname.lastIndexOf("/");
                    var index2 = pathname.lastIndexOf(".");
                    str = str + pathname.substring(index1+1,index2) + " " + this["product3"][i][0] + " ";
                }
                for(var i=0; i < this["product4"].length; i++) {
                    var pathname = this["product4"][i][1];
                    var index1 = pathname.lastIndexOf("/");
                    var index2 = pathname.lastIndexOf(".");
                    str = str + pathname.substring(index1+1,index2) + " " + this["product4"][i][0] + " ";
                }
                return str;
            }
        };

        questions = {
            "current":0,
            "answers":[]
        };

        tests = {
            "start":0,
            "group":0,
            "current":0,
            "answers":[]
        };
    }

    function main() {

        var number = order_number;
        if(number == 0){
            var url = location.href;
            console.log("url:", url)
            var number_str = url.substring(url.lastIndexOf("_")+1, url.lastIndexOf("."));
            var number = parseInt(number_str);
            if(number == NaN){
                number = 0;
                console.log("invalid number, reset to 0");
            }
        }else{
            console.log("using order number:", number);
        }
        reset_config(number);

        print_config(config);
        register_key_event(config);
        change_state(config);
        window.setInterval(working_machine, 10, config);
        window.setInterval(check_and_show_next, 10, config);
    }


    main();


</script>

</html>